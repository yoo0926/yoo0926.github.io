<!doctype html>
<html lang="ko"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="naver-site-verification" content="ab9573df103dfc4dfc214b8015c103cf14d9fcce"><meta><title>하루하루 끄적끄적</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="하루하루 끄적끄적"><meta name="msapplication-TileImage" content="/img/favicon.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="하루하루 끄적끄적"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="티끌모아 태산이라 티끌부터 모아본다."><meta property="og:type" content="blog"><meta property="og:title" content="하루하루 끄적끄적"><meta property="og:url" content="https://yoo0926.github.io/"><meta property="og:site_name" content="하루하루 끄적끄적"><meta property="og:description" content="티끌모아 태산이라 티끌부터 모아본다."><meta property="og:locale" content="ko_KR"><meta property="og:image" content="https://yoo0926.github.io/img/og_image.png"><meta property="article:author" content="Jaeyong Yoo"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://yoo0926.github.io"},"headline":"하루하루 끄적끄적","image":["https://yoo0926.github.io/img/og_image.png"],"author":{"@type":"Person","name":"Jaeyong Yoo"},"publisher":{"@type":"Organization","name":"하루하루 끄적끄적","logo":{"@type":"ImageObject","url":"https://yoo0926.github.io/img/logo-header.png"}},"description":"티끌모아 태산이라 티끌부터 모아본다."}</script><link rel="icon" href="/img/favicon.png"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.2/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><script src="https://www.googletagmanager.com/gtag/js?id=G-EKSGRQ3VMZ" async></script><script>window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
    
        gtag('config', 'G-EKSGRQ3VMZ');</script><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><!--!--><!--!--><script data-ad-client="ca-pub-4055492668550708" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js" async></script><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/rss2.xml" title="하루하루 끄적끄적" type="application/rss+xml">
</head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo-header.png" alt="하루하루 끄적끄적" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="external nofollow noopener noreferrer" title="Download on GitHub" href="https://github.com/yoo0926/yoo0926.github.io"><i class="fab fa-github"></i></a><a class="navbar-item search" title="검색" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-9-tablet is-9-desktop is-9-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time datetime="2023-03-02T15:24:17.000Z" title="2023. 3. 3. 오전 12:24:17">2023-03-03</time>&nbsp;게시 됨</span><span class="level-item"><time datetime="2023-06-19T15:33:29.705Z" title="2023. 6. 20. 오전 12:33:29">2023-06-20</time>&nbsp;업데이트 됨</span><span class="level-item"><a class="link-muted" href="/categories/etc/">etc</a></span><span class="level-item">23분안에 읽기 (약 3504 단어)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/03/03/etc/naver-deview-2023/">DEVIEW 2023 - Day1</a></h1><div class="content"><p>2023-02-27 ~ 28 에 진행했던 deview day01 컨퍼런스 내용을 간단히 정리했다.<br>
내용은 좋았다고 느꼈지만 당장 내 실무에 도움된다기 보단 그냥 시야를 넓히고 이런게 트랜드구나 하는 걸 들었다는거에 의의를 두기로 했다.</p>
<h2 id="네이버-검색은-어떻게-나보다-더-내-의도를-잘-아는가-AiRSearch-반응형-추천">네이버 검색은 어떻게 나보다 더 내 의도를 잘 아는가? - AiRSearch 반응형 추천</h2>
<p>네이버는 현재 사용자 의도에 적합한 검색 결과를 제공하도록 여러가지 추천 알고리즘이 적용되어있다.</p>
<p>사용자 의도를 이해하는 방법은 크게 두가지가 있는데</p>
<ol>
<li>검색어
<ul>
<li>
<p>사용자가 질의하는 검색어(쿼리)를 통해 의도를 예측한다.</p>
</li>
<li>
<p>검색어 입력 후 탐색과정에서 관심사와 검색의도를 더 구체화할 수 있다.</p>
<blockquote>
<p>ex) 제주도여행 검색 후 결과목록<br>
Doc1 : 제주도에서 <code>고등어</code>가 맛있는 식당 추천<br>
Doc2 : 12월 제주도 겨울 여행<br>
Doc3 : 제주도 <code>가파도</code> 배시간 &amp; 올레길 추천</p>
</blockquote>
<p>여기서 3번째 문서를 클릭했다면 사용자의 관심사는 고등어 보단 가파도에 있다는걸 파악할 수 있다.</p>
</li>
<li>
<p>사용자의 행동을 바탕으로 의도를 이해하고 반응형으로 컨텐츠를 빠르게 제공하는데 여기서 반응형 추천결과란 선택한 문서를 읽고 다시 뒤로가기로 나오게 되면 관심사와 유사한 다른 문서를 추천하는 방식이다.</p>
</li>
</ul>
</li>
</ol>
<h3 id="반응형-문제를-해결하기">반응형 문제를 해결하기</h3>
<ol>
<li>반응형 문제 정의
<ul>
<li>언제 / 어디서 / 누구에게? : 네이버 통합검색에서 문서를 소비하고 돌아온 사용자들에게</li>
<li>Input : 사용자의 행동 기반 정보들 (검색어, 클릭한 문서, 사용자의 취향 정보 등)</li>
<li>Output : 추천 문서</li>
</ul>
<ol>
<li>반응형 문제의 특징으로 검색 사용자의 2가지 탐색 패턴이 있다.
<ol>
<li>국내여행 → 제주도 여행 검색 후
<ol>
<li><code>Narrow-Down</code> → 가파도</li>
<li><code>Side-By-Side</code> → 일본여행</li>
</ol>
</li>
</ol>
</li>
<li>두번째는 검색과 추천의 융합이 필요하다.
<ol>
<li>검색어를 통해 단순히 결과를 보여주거나 클릭한 문서 기반의 추천문서만 보여주는게 아니라 검색어와 클릭한 문서를 종합하여 추천문서를 보여주려고 한다.</li>
</ol>
</li>
</ol>
</li>
<li>반응형 문제를 정의하였다면 이제 이러한 문제를 해결하기 위한 모델을 만들었다.
<ul>
<li>Input : Query, Clicked Document, User</li>
<li>Retriever : 각 요소를 기반 검색</li>
<li>Ranker : 결과 정렬</li>
<li>Output : 추천문서 제공</li>
</ul>
</li>
</ol>
<h3 id="반응형-문제를-풀기-위한-3가지-방법">반응형 문제를 풀기 위한 3가지 방법</h3>
<ol>
<li>Intent Query
<ul>
<li>클릭한 문서의 제목에서 핵심 의도를 표한하는 키워드 찾기</li>
<li>네이버 언어모델을 기반으로 (Q1,D1)와 적합한 Intent Query의 유사도가 높도록 학습</li>
<li>검색 세션 로그 (Q1,D1) → Q2를 이용해서 학습 데이터를 구축하고 의도를 벗어나는 Q2는 예외처리</li>
</ul>
</li>
<li>Intent Walker
<ul>
<li>그래프 기반으로 사용자 의도에 맞는 문서 추천하기
<ul>
<li>클릭로그 활용 탐색과정 그래프 생성</li>
</ul>
</li>
<li>유저가 클릭한 문서를 시작점으로 아래의 방법들을 실행
<ul>
<li>랜덤 워크 수행</li>
<li>Label Propagation 수행</li>
<li>(검색어-클릭문서), (세션ID - 클릭문서) 페어 등을 기반으로 GCN 임베딩 학습</li>
</ul>
</li>
</ul>
</li>
<li>User Preference
<ul>
<li>유저의 취향에 적합한 문서를 추천
<ul>
<li>Q1) <code>후드</code>집업 + D1) 오버핏 후드집업 <code>양털후리스</code> + U1) <code>30대 남성</code>
<ul>
<li>D2) 너무 편한 <code>남자</code> <code>후리스</code> 추천 모음</li>
</ul>
</li>
<li>추천 문서에 대한 long-term의 세대성별 선호도를 ranker의 feature로 추가</li>
<li>개인의 short-term 관심사 기반한 개인화 랭킹 연구 중</li>
</ul>
</li>
</ul>
</li>
</ol>
<h3 id="반응형-서비스-개발을-위한-꿀팁">반응형 서비스 개발을 위한 꿀팁</h3>
<ol>
<li>문제를 작게 정의하기
<ul>
<li>이런경우 막연하게 풀고 싶은 큰 문제를 구체적이고 해결 가능성이 있는 작은 문제부터 시작한다.</li>
<li>ex) 사용자의도가 Narrow-Down vs Side-By-Side ? → Narrow-Down만 있다고 가정<br>
대상 문서 : 여행 등 일부 카테고리 한정</li>
<li>작은 문제의 장점은 아래와 같은데 애자일 방법론과 유사한거 같다.
<ul>
<li>빠른 개발</li>
<li>문제 해결 가능성과 효과 검증</li>
<li>사용자의 피드백으로 문제 확장</li>
</ul>
</li>
</ul>
</li>
<li>학습데이터 잘 구축하기
<ul>
<li>(Q1, D1) → 후보 D2의 적합도 [0,1] or [1,2,3,4]
<ul>
<li>서비스 출시 전 소량의 Manual 평가를 거친 후</li>
<li>서비스 출시 후 사용자 피드백을 기반으로 생성한다.<br>
(ex) 클릭 받으면 1, 아니면 0)
<ul>
<li>단점?어려운점? : 모델 bias(편향), 클릭은 없지만 적합 문서</li>
<li>개선 아이디어로 CTR 역전되면 Negative
<ul>
<li>검색에는 Rank Bias 존재</li>
<li>하위 노출 문서보다 CTR이 낮은 상위 문서는 매력이 낮을 가능성 있음</li>
<li>D1,D2 보다 D3의 CTR이 높은 경우 D1,D2 는 Negative 후보</li>
</ul>
</li>
</ul>
</li>
<li>positive set과 negative set을 후보로 모아서 Manual그룹평가와 비교하여 신뢰도를 측정하고 최종 선정된 Top3 학습데이터 weekly 생성한다.</li>
</ul>
</li>
</ul>
</li>
<li>ABTest 활용하기 : ABTest 결과를 바탕으로 최종 검증 모델로 서비스 적용</li>
<li>지표 모니터링하기 : CTR, 체류시간, LCR(마지막 클릭 비율) 등을 모니터링하여 사용자 만족도 측정 및 모델 개선 참고</li>
</ol>
<hr>
<h2 id="눈으로-보며-듣는-음성-기록-클로바노트-서비스의-웹-기술-톺아보기">눈으로 보며 듣는 음성 기록, 클로바노트 서비스의 웹 기술 톺아보기</h2>
<p>클로바노트 2.x 버전에서 지원할 웹기술을 살펴보자</p>
<ol>
<li>오프라인 지원
<ul>
<li>Progressive Web Application(PWA) : Next.js +next-pwa + workbox로 구현</li>
<li>오프라인 API 중 R-Get을 제외한 나머지 C-Post U-Put,Patch D-Delete 는 불필요하여 막았고 LocalStorage와 IndexedDb를 활용하였음</li>
<li>가장 큰 골칫거리는 Update 후 Deploy 방식이었는데
<ul>
<li>주기적인 최신버전 체크, 수동 업데이트 진행, 강제 업데이트 로직 추가, 에러 시 SW 제거 및 해당버전 재설치 방지 등을 통해 처리하였음?</li>
</ul>
</li>
<li>PWA의 Service Worker의 XHR cache에 XHR 분기를 추가
<ul>
<li>[API Wrapper - [Fetch, Axios, <em>Socket</em>.io]] → Service Worker</li>
</ul>
</li>
</ul>
</li>
<li>반응형 지원</li>
<li>ZOOM 서비스 연결
<ol>
<li>줌에서 제공하는 API 중 REST API와 WebHook을 이용하였음</li>
<li>회의 시작, 종료에 맞춰서 훅을 받아서 녹음파일을 업로드하여 노트를 생성하도록 자동화 하였으나 좀 더 직접적인 도움을 주고 싶었음
<ol>
<li>실시간으로 가져오도록 구현해보자</li>
<li>ZOOM의 라이브스트림을 통해 다른 플랫폼으로 스트리밍을 제공하는데 이것을 활용 - RTMP(Real Time Message Protocol)</li>
<li>이를 위해 백엔드 서버가 필요했는데 Node-Media-Server 가 원하는 스펙이 모두 있었고 BFF(Backend for Frontend) 서버를 개발하였음</li>
<li>이제 회의시작 후 실시간으로 노트생성이 가능해졌다.</li>
</ol>
</li>
<li>예외처리
<ol>
<li>웹훅 API, RTMP 타이밍 문제</li>
<li>네트워크 등의 오류로 웹훅을 받을 수 없을때
<ul>
<li>프로세스가 진행되는 동안 주기적으로 REST API 더블체크하도록 처리하였음</li>
</ul>
</li>
</ol>
</li>
</ol>
</li>
<li>모노레포
<ul>
<li>Multi Repo에서 Mono Repo로 합치게 되면서 팀으로서의 장점이 뚜렷해졌음</li>
<li>기술적 장점
<ul>
<li>반복적인 환경 셋팅, 코드 중복 최소화</li>
<li>효율적인 의존성 관리</li>
<li>단일 이슈 트래킹</li>
<li>각자의 역할에 집중된 작은 패키지들</li>
<li>린트외의 팀 규칙을 적용하여 신규입사자의 컨텍스트 파악이 용이해지고 적극적인 리뷰문화를 도입할 수 있었다.</li>
</ul>
</li>
<li>모노레포는 최대한 간단하게하고 빌드 캐싱은 Docker 활용</li>
</ul>
</li>
<li>아토믹 디자인 패턴
<ul>
<li>컴포넌트를 가장 작은 단위로 설정하여 상위 컴포넌트를 만들어 코드 재사용을 최대화하는 방식
<ul>
<li>원자(아톰) → 분자 → 유기체 → 템플릿 → 페이지 구조</li>
</ul>
</li>
<li>그대로 사용하기엔 재사용하지 않아도 되는 부분까지 나눠야하는 불편함이 있어서 일반적인 UI 라이브러리에서 제공하는 수준을 아톰으로 정의하여 구조를 잡았음</li>
</ul>
</li>
<li>리코일
<ul>
<li>Flux / Redux 의 모든 기능이 가능하고 상대적으로 낮은 러닝커브를 가졌음</li>
<li>자체적인 <code>비동기</code> 지원</li>
<li>React18 <code>동시성</code>의 장점을 그대로 사용할 수 있는 라이브러리</li>
<li>일반적인 리코일 폴더구조는 리코일에 직접접근이 가능하여 프로젝트가 커질수록 종속성이 복잡해지고 디버깅이 어렵다.
<ul>
<li>결과적으로 컴포넌트의 복잡함이 리코일로 이동한것에 불과하다.</li>
</ul>
</li>
<li>격리된 도메인별 리코일
<ul>
<li>아톰, 셀렉터에 직접 접근 없이 훅으로만 연결</li>
<li>리코일 훅은 서로 참조하지 않는다.(인증 제외)</li>
<li>순서가 필요하다면 비지니스 컴포넌트 사용</li>
</ul>
</li>
</ul>
</li>
</ol>
<hr>
<h2 id="네이버-스마트블록-개인화-검색">네이버 스마트블록 개인화 검색</h2>
<p>와… 이건 듣는거만으론 이해불가라 포기</p>
<hr>
<h2 id="네이버-스케일로-카프카-컨슈머-사용하기">네이버 스케일로 카프카 컨슈머 사용하기</h2>
<ol>
<li>Kafka Consumer 동작 원리
<ol>
<li>Topic : 1개 이사의 Partition으로 분할, 1개 이상의 Replica로 복제된 log 자료 구조</li>
<li>Client
<ol>
<li>Producer : 쓰고자 하는 Topic Partition의 맨 끝에 record를 추가</li>
<li>Consumer : 읽어오고자 하는 Topic의 Partition에 저장된 record를 순차적으로 읽어 옴</li>
</ol>
</li>
<li>Consumer Group
<ul>
<li>같은 ‘ <a target="_blank" rel="external nofollow noopener noreferrer" href="http://group.id">group.id</a>’ 설정값을 가진 Consumer들은 하나의 Consumer Group 을 이룬다.</li>
<li>같은 Consumer Group에 속한 Consumer들이 Topic에 속한 Parition들을 나눠서 읽는다.</li>
<li>Consumer Group == “논리적인 Consumer”</li>
<li>Consumer Group이 제대로 동작하기 위해선 아래 기능이 필요하다.
<ol>
<li>Parition Assignment 기능</li>
<li>Offset Commit 기능</li>
</ol>
</li>
</ul>
</li>
<li>Consumer Coordination 동작원리</li>
</ol>
<ul>
<li>Consumer Group Coordinator
<ol>
<li>Consumer Group에 변경이 생겼는지 탐지</li>
<li>TopicParition에 변경이 생겼는지 탐지</li>
<li>Consumer Group Leader와 나머지 Consumer들간의 communication 중개</li>
</ol>
</li>
<li>Consumer Group Leader
<ul>
<li>현재 구독중인 topic의 파티션들을 consumer들에 할당</li>
</ul>
</li>
<li>Broker를 재시작할 필요 없이 더 유연하고 확장 가능한 파티션 할당을 지원하기 위해 좀 복잡한 구조로 만들어짐</li>
<li>관련 설정
<ul>
<li>partition.assignment.strategy
<ul>
<li>List of org.apache.kafka.clients.consumer.ConsumerPartitionAssignor class</li>
</ul>
<ol>
<li>Consumer Group에 참여한 모든 Consumer에 공통으로 설정된 Assignor중에서</li>
<li>우선순위가 가장 높은 것이 파티션 할당 전략으로 선택</li>
</ol>
</li>
</ul>
</li>
</ul>
</li>
<li>Cloud 환경에서 Kafka Consumer 사용하기<br>
1.</li>
<li>네이버 스케일로 Kafka Consumer 사용하기</li>
</ol>
<p>카프카에 대해서 제대로 공부하지 않고 이 내용을 정리하는건 의미가 없다고 판단되서 나중에 다시 정리해보자…</p>
<hr>
<h2 id="GraphQL-잘-쓰고-계신가요">GraphQL 잘 쓰고 계신가요?</h2>
<ol>
<li>GraphQL이란
<ul>
<li><code>필요한 것만</code> 요청하고 받아오기</li>
<li><code>단일 요청</code>으로 많은 데이터 가져오기</li>
<li>가능한 케이스를 <code>타입 시스템</code>으로 표현하기</li>
</ul>
</li>
</ol>
<p>단순히 Payload를 줄이기 위해서만 사용하는건 아니다. 제대로 사용하지 않는다면 REST API와 크게 다를게 없는 경우도 발생한다.</p>
<p>도입배경</p>
<p>화면 컴포넌트를 구성하는 다양한 데이터를 여러 API를 호출하여 조회하는데 GraphQL BFF 를 통하면 개별 API 스펙을 크게 신경쓰지 않아도 된다.</p>
<ol>
<li>
<p>Schema</p>
<ol>
<li>
<p>데이터의 모양으로 DB의 스키마는 데이터를 R/W 하는데 최적화를 목적으로 관계와 참조로 중복을 해소한다(정규화)</p>
</li>
<li>
<p>GraphQL 스키마는 클라이언트를 중심으로 생각하는 출처가 다른 데이터들의 통합 타입 시스템을 의미한다.</p>
</li>
<li>
<p>Enum을 적극적으로 활용한다</p>
 <figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> <span class="title class_">Profile</span> &#123;</span><br><span class="line">	name : <span class="title class_">String</span></span><br><span class="line">	thumbnail42 : <span class="title class_">String</span></span><br><span class="line">	thumbnail60 : <span class="title class_">String</span></span><br><span class="line">	...</span><br><span class="line">	<span class="attr">backgroundImage42</span>: <span class="title class_">String</span></span><br><span class="line">	...</span><br><span class="line">	<span class="attr">backgroundImage200</span>: <span class="title class_">String</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Enum 사용</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Profile</span> &#123;</span><br><span class="line">	name : <span class="title class_">String</span></span><br><span class="line">	<span class="title function_">thumbnailImage</span>(<span class="attr">width</span>: <span class="title class_">ImageWidth</span> = <span class="variable constant_">W_42</span>): <span class="title class_">String</span>!</span><br><span class="line">	<span class="title function_">backgroundImage</span>(<span class="attr">width</span>: <span class="title class_">ImageWidth</span> = <span class="variable constant_">W_100</span>): <span class="title class_">String</span>!</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Enum을 사용함으로 좀 더 명확하게 표현하여 실수를 줄일 수 있다.</p>
</li>
<li>
<p>암시적인 의미의 API를 좀 더 명시적으로 한다.</p>
<ol>
<li>여기서도 Enum을 사용하는데 empty가 의미를 가질 때 Enum을 사용할 수 있다.</li>
</ol>
 <figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum</span> <span class="title class_">MediaFilter</span> &#123;</span><br><span class="line">	<span class="variable constant_">WITH_MEDIA</span></span><br><span class="line">	<span class="variable constant_">WITHOUT_MEIDA</span></span><br><span class="line">	<span class="variable constant_">ALL</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Query</span> &#123;</span><br><span class="line">	<span class="title function_">placeReviews</span>(<span class="attr">placeId</span>: <span class="variable constant_">ID</span>!, <span class="attr">mediaFilter</span>: <span class="title class_">MediaFilter</span> = <span class="variable constant_">ALL</span>): [<span class="title class_">Review</span>!]!</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>API 사용자관점으로 명확하게 스키마를 표현한다.</p>
</li>
<li>
<p>Error Handling</p>
<ol>
<li>
<p>다양한 에러를 대응하고 메타데이터가 필요한 경우 이러한 상태값을 단순히 타입으로 추가한다면 여러 데이터가 복잡하게 얽히게 된다.</p>
</li>
<li>
<p>Union 타입을 사용한다.</p>
 <figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//union Result = Succeed | Error</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">DuplicationError</span> &#123;</span><br><span class="line">	<span class="attr">message</span>: <span class="title class_">String</span>!</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">type</span> <span class="title class_">PwordError</span> &#123;</span><br><span class="line">	<span class="attr">workds</span>: [<span class="title class_">String</span>!]!</span><br><span class="line">	<span class="attr">message</span>: <span class="title class_">String</span>!</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">union <span class="title class_">CheckNickNameOutput</span> = <span class="title class_">NickNameSucceed</span> | <span class="title class_">DuplicationError</span> | <span class="title class_">PwordError</span></span><br></pre></td></tr></table></figure>
<p>다만, 유니온 타입만으론 새로운 스펙과 에러가 추가된다면 데이터를 받을 수 없다. 즉, 확장에 닫혀있는 상태이다.</p>
</li>
<li>
<p>Interface를 적용하여 명시적이고 유연하게 에러 핸들링이 가능하다.</p>
 <figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">BaseError</span> &#123;</span><br><span class="line">	<span class="attr">message</span>: <span class="title class_">String</span>!</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Duplication</span> <span class="keyword">implements</span> <span class="title class_">BaseError</span> &#123;</span><br><span class="line">	<span class="attr">message</span>: <span class="title class_">String</span>!</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">type</span> <span class="title class_">PwordError</span> <span class="keyword">implements</span> <span class="title class_">BaseError</span> &#123;</span><br><span class="line">	<span class="attr">words</span>: [<span class="title class_">String</span>!]!</span><br><span class="line">	<span class="attr">message</span>: <span class="title class_">String</span>!</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">type</span> <span class="title class_">CountOverError</span> <span class="keyword">implements</span> <span class="title class_">BaseError</span> &#123;</span><br><span class="line">	<span class="attr">count</span>: <span class="title class_">Int</span>!</span><br><span class="line">	<span class="attr">message</span>: <span class="title class_">String</span>!</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
</li>
</ol>
<p>아래 내용이 더 있으나 GraphQL이 어떻게 사용되는지 대략적인 개요를 한번 들어보고 싶었던거고 뒷부분은 리액트 관련 기술들이랑 좀 더 심화된 내용들이라 굳이 정리하지 않음</p>
<p>결국 해당 팀에서도 별도의 GraphQL용 BFF 서버를 만들어서 운영중이라고 하니 REST API 처럼 별도의 GraphQL 스펙의 API 서버 쪽 공부를 더 해보도록 하자</p>
</li>
</ol>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time datetime="2023-03-01T07:55:02.000Z" title="2023. 3. 1. 오후 4:55:02">2023-03-01</time>&nbsp;게시 됨</span><span class="level-item"><time datetime="2023-06-10T11:50:15.895Z" title="2023. 6. 10. 오후 8:50:15">2023-06-10</time>&nbsp;업데이트 됨</span><span class="level-item"><a class="link-muted" href="/categories/book/">book</a><span> / </span><a class="link-muted" href="/categories/book/clean-architecture/">clean-architecture</a></span><span class="level-item">12분안에 읽기 (약 1738 단어)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/03/01/book/clean-architecture/clean-2/">2. 의존성 역전하기</a></h1><div class="content"><p>계층형 아키텍처의 대안을 이야기 하기전에 SOLID 원칙의 ‘S’와 ‘D’를 담당하는 아래 원칙들을 먼저 살펴보자.</p>
<h3 id="단일-책임-원칙-Single-Responsibility-Principle-SRP">단일 책임 원칙(Single Responsibility Principle, SRP)</h3>
<ul>
<li>하나의 컴포넌트는 오로지 한 가지 일만 해야 하고, 그것을 올바르게 수행해야 한다.
<ul>
<li>이 말은 실제 의도와는 조금 다른 오해가 발생할 여지가 있으니 아래 정의가 좀 더 정확하다고 볼 수 있다.</li>
</ul>
</li>
<li>컴포넌트를 변경하는 이유는 오직 하나뿐이어야 한다.</li>
</ul>
<p>만약 컴포넌트를 변경할 이유가 한 가지라면 우리가 “어떤 다른 이유로” 소프트웨어를 변경하더라도 이 컴포넌트에 대해선 전혀 신경 쓸 필요가 없다.</p>
<p>하지만 변경할 이유라는건 컴포넌트 간의 의존성을 통해 너무 쉽게 전파된다.<br>
A 컴포넌트는 B,C,D,E에 의존하고 E는 다른 의존성이 없다면<br>
A는 다른 B,C,D,E가 바뀔 때 함께 바뀌어야 하지만 E는 E에 기능이 추가,변경될 때만 바뀌게 될 것이다.</p>
<h3 id="의존성-역전-원칙-Dependency-Inversion-Principle-DIP">의존성 역전 원칙(Dependency Inversion Principle, DIP)</h3>
<p>계층형에서 계층 간 의존성은 항상 다음 계층인 아래 방향을 가리킨다. 단일 책임 원칙을 고수준에서 적용할 경우 상위 계층들이 하위 계층들에 비해 변경할 이유가 더 많다.</p>
<p>그러므로 영속성 계층에 대한 도메인 계층의 의존성 때문에 영속성 계층을 변경할 때마다 잠재적으로 도메인 계층도 변경해야 한다. 하지만 도메인 코드는 애플리케이션에서 가장 중요한 코드인데 영속성 코드가 바뀐다고 도메인 코드까지 바꾸는게 맞을까? 이 의존성은 어떻게 제거할 수 있을까? 의존성 역전 원칙은 말 그대로의 의미이다.</p>
<ul>
<li>코드 상의 어떤 의존성이든 그 방향을 바꿀 수(역전시킬 수) 있다.
<ul>
<li>단, 서드파티 라이브러리처럼 제어할 수 없는 코드에 의존성을 가지고 있다면 역전이 불가능하다.</li>
</ul>
</li>
</ul>
<p>일반적으로 보기 쉬운 계층형 구조의 서비스가 있다. 도메인 계층의 서비스는 영속성 계층의 엔티티와 리포지토리와 상호작용한다.</p>
<p>엔티티는 도메인 객체를 표현하고 도메인 코드는 이러한 엔티티의 상태를 변경하는 일을 중심으로 하니까 일단 엔티티를 도메인 계층으로 올려보면 영속성의 리포지토리가 도메인의 엔티티를 의존하는 순환의존성이 생기게 된다.</p>
<p style="text-align:center">
  <img src="/img/book/clean-architecture/clean-2-1.jpg">
</p>
<p>여기서 DIP를 적용하면 도메인 계층에 리포지토리에 대한 인터페이스를 만들고, 실제 리포지토리는 영속성 계층에서 구현하게 하는 것이다.</p>
<p style="text-align:center">
  <img src="/img/book/clean-architecture/clean-2-2.jpg" style="width:500px; height:auto">
</p>
<p>이제 도메인 계층에 인터페이스를 도입함으로써 의존성을 역전시켜서 도메인 로직은 영속성 코드에 의존하지 않고 영속성 계층이 도메인 계층에 의존하게 된다.</p>
<h3 id="클린-아키텍처">클린 아키텍처</h3>
<p>도메인 코드가 바깥으로 향하는 어떤 의존성도 없어야 함을 의미한다. 대신 의존성 역전 원칙의 도움으로 모든 의존성이 도메인 코드를 향하고 있다.</p>
<p>클린 아키텍처의 코어에는 주변 유스케이스에서 접근하는 도메인 엔티티들이 있다. 유스케이스는 서비스를 의미하는데 단일 책임을 갖기 위해 좀 더 세분화 시켜서 넓은 서비스 문제를 피한다.</p>
<p>도메인 코드에선 어떤 영속성 프레임워크나 UI 프레임워크가 사용되는지 알 수 없기 때문에 특정 프레임워크에 특화된 코드를 가질 수 없고 비즈니스 규칙에 집중할 수 있어서 자유롭게 모델링할 수 있다.</p>
<p>다만, 도메인 계층이 영속성이나 UI 같은 외부 계층과 철저하게 분리돼야 하므로 애플리케이션의 엔티티에 대한 모델을 각 계층에서 유지보수 해야 한다.</p>
<p>영속성에서 ORM을 사용하는 경우, 도메인 계층과 영속성 계층이 데이터를 주고받을 때, 두 계층에 각각 엔티티 클래스를 만들어서 서로 변환해야 하는데 이는 바람직한 방향이다.</p>
<p>특정 프레임워크에 특화된 문제로부터 해방시키고자 했던, 결합이 제거된 상태이다.</p>
<p>클린 아키텍처는 약간 추상적인 느낌이 강해서 이 원칙들을 좀 더 구체적으로 만들어주는 ‘육각형 아키텍처(헥사고날 아키텍처)’에 대해서 살펴보자.</p>
<h3 id="육각형-아키텍처-헥사고날-아키텍처">육각형 아키텍처(헥사고날 아키텍처)</h3>
<p>애플리케이션 코어가 각 어댑터와 상호작용하기 위해 특정 포트를 제공하기 때문에 ‘포트와 어댑터 아키텍처라고도 불린다. 꼭 육각형의 모양이 중요한건 아니고 팔각형이어도 상관없다.</p>
<p>육각형 안에는 도메인 엔티티와 이와 상호작용하는 유스케이스가 있다. 외부로 향하는 의존성이 없고 모든 의존성은 코어를 향한다.</p>
<p>육각형 바깥에는 웹 브라우저와 상호작용하는 웹 어댑터, 데이터베이스와 상호작용하는 영속성 어댑터, 외부 시스템와 상호작용하는 어댑터 등 애플리케이션과 상호작용하는 다양한 어댑터들이 있다.</p>
<p>코어와 어댑터들 간의 통신이 가능하려면 애플리케이션 코어가 각각의 포트를 제공해야 한다.</p>
<p>주도하는 어댑터에게는 포트가 코어에 있는 유스케이스 클래스들에  의해 구현되고 호출되는 인터페이스가 될 것이고, 주도되는 어댑터에는 어댑터에 의해 구현되고 코어에 의해 호출되는 인터페이스가 될 것이다.</p>
<p>이러한 아키텍처의 목적은 결국 도메인 코드가 바깥쪽 코드에 의존하지 않게 함으로써 영속성과 UI에 특화된 모든 문제로부터 도메인 로직의 결합을 제거하고 코드를 변경할 이유의 수를 줄이는 효과가 있다.</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time datetime="2023-03-01T06:12:15.000Z" title="2023. 3. 1. 오후 3:12:15">2023-03-01</time>&nbsp;게시 됨</span><span class="level-item"><time datetime="2023-06-10T11:47:05.093Z" title="2023. 6. 10. 오후 8:47:05">2023-06-10</time>&nbsp;업데이트 됨</span><span class="level-item"><a class="link-muted" href="/categories/book/">book</a><span> / </span><a class="link-muted" href="/categories/book/clean-architecture/">clean-architecture</a></span><span class="level-item">7분안에 읽기 (약 1093 단어)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/03/01/book/clean-architecture/clean-3/">3. 코드 구성하기</a></h1><div class="content"><p>코드만 보더라도 어떤 아키텍처인지 알 수 있다면 좋지 않을까? 보통 새로운 프로젝트를 시작할 때 가장 먼저 패키지 구조를 설계하게 된다.</p>
<h3 id="계층으로-구성하기">계층으로 구성하기</h3>
<p>기본적인 계층형으로 프로젝트를 생성한다면 아래와 같은 구조가 될 것이다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">buckpal</span><br><span class="line">    ├─domain</span><br><span class="line">    │	├─Account</span><br><span class="line">    │	├─Activity</span><br><span class="line">    │	├─AccountRepository</span><br><span class="line">    │	└─AccountService</span><br><span class="line">    ├─persistence</span><br><span class="line">    │	└─AccountRepositoryImpl</span><br><span class="line">    └─web</span><br><span class="line">    	└─AccountController</span><br></pre></td></tr></table></figure>
<p>도메인, 웹, 영속성 계층별로 패키지를 만들었고 앞서 나왔던 의존성 역전을 사용하여 domain 패키지에 AccountRepository 인터페이스를 두고 persistence 패키지에 구현체를 둬서 의존성이 도메인을 바라보도록 구성되어있다.</p>
<p>다만 몇가지 단점이 보이는데</p>
<ol>
<li>기능이나 특성을 구분짓는 패키지의 경계가 없다.
<ul>
<li>새로운 기능(ex) 사용자관리)을 추가하려면 각 계층 패키지에 UserController, UserService, User 등을 추가하게 되는데 다른 기능과 섞이게 되면 예상치 못한 부수효과가 발생할 수 있다.</li>
</ul>
</li>
<li>애플리케이션이 어떤 유스케이스를 제공하는지 파악하기 어렵다.
<ul>
<li>AccountController와 AccountService가 구체적으로 어떤 기능을 제공하는지 파악하려면 내부 구현 메서드를 살펴봐야 한다.</li>
</ul>
</li>
<li>패키지만 봐서 의도하는 아키텍처를 짐작하기 어렵다.
<ul>
<li>육각형 아키텍처라고 추측하고 웹 어댑터와 영속성 어댑터를 찾기 위해 web, persistence 패키지를 조사해볼 순 있지만 어떤 기능이 웹어댑터에서 호출되는지, 영속성 어댑터가 도메인 계층에 어떤 기능을 제공하는지 한눈에 알 수 없다. 인커밍 포트와 아웃고잉 포트가 코드 속에 숨겨져 있다.</li>
</ul>
</li>
</ol>
<h3 id="기능으로-구성하기">기능으로 구성하기</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">buckpal</span><br><span class="line">    └─account</span><br><span class="line">    	├─Account</span><br><span class="line">    	├─AccountController</span><br><span class="line">    	├─AccountRepository</span><br><span class="line">    	├─AccountRepositoryImpl</span><br><span class="line">    	└─SendMoneyService</span><br></pre></td></tr></table></figure>
<p>계좌 관련 기능을 모두 account 라는 패키지에 모았고 AccountService도 책임을 좁히기 위해서 SendMoneyService로 변경하였다.</p>
<p>이렇게 되면 ‘송금하기’ 유스케이스를 구현한 코드는 클래스명만 봐도 바로 찾을 수 있다.</p>
<p>하지만 기능을 기준으로 코드를 구성하면 기반 아키텍처가 명확하게 보이지 않아서 가시성이 많이 떨어진다는 큰 단점이 있다.</p>
<h3 id="아키텍처적으로-표현력-있는-패키지-구조">아키텍처적으로 표현력 있는 패키지 구조</h3>
<p>육각형 아키텍처에서 구조적으로 핵심적인 요소는 엔티티, 유스케이스, 인커밍/아웃고잉 포트, 인커밍/아웃고잉(혹은 주도하거나 주도되는) 어댑터이다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">buckpal</span><br><span class="line">    └─account</span><br><span class="line">        ├─adapter</span><br><span class="line">        │    ├─<span class="keyword">in</span></span><br><span class="line">        │    │  └─web</span><br><span class="line">        │    │     └─AccountController</span><br><span class="line">        │    ├─out</span><br><span class="line">        │    └─persistence</span><br><span class="line">        │        ├─AccountPersistenceAdapter</span><br><span class="line">        │        └─SpringDataAccountRepository</span><br><span class="line">        ├─domain</span><br><span class="line">        │    ├─Account</span><br><span class="line">        │    └─Activity</span><br><span class="line">        └─application</span><br><span class="line">              ├─SendMoneyService</span><br><span class="line">              └─port</span><br><span class="line">                  ├─<span class="keyword">in</span></span><br><span class="line">                  │  └─SendMoneyUseCase</span><br><span class="line">                  └─out</span><br><span class="line">                      ├─LoadAccountPort</span><br><span class="line">                      └─UpdateAccountStatePort	</span><br></pre></td></tr></table></figure>
<p>도메인 모델이 속한 domain 패키지와 도메인 모델을 둘러싼 서비스 계층을 포함하는 application패키지가 있다.</p>
<p>SendMoneySerivce는 인커밍 포트 인터페이스인 SendMoneyUseCase를 구현 아웃고잉 포트 인터페이스이자 영속성 어댑터에 의해 구현된 LoadAccountPort와 UpdateAccountStatePort를 사용한다.</p>
<p>adapter 패키지는 애플리케이션 계층의 인커밍 포트를 호출하는 인커밍 어댑터와 애플리케이션 계층의 아웃고잉 포트에 대한 구현을 제공하는 아웃고잉 어댑터를 포함한다.</p>
<ul>
<li>책을 읽다가 곰곰히 생각해 봤지만<br>
패키지의 구조가 표현력이 있긴한데 아직 익숙치 않아서 한눈에 들어오진 않는다. 다만, 팀원들과 이러한 아키텍처에 대한 논의가 충분히 되고 합의된 상태에서 구조를 잡는다면 코드와 아키텍처가 직접적으로 매핑되면서 추상적이던 아키텍처가 좀 더 구체적으로 파악이 가능해진거 같기도 하다.</li>
</ul>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time datetime="2023-02-25T07:55:02.000Z" title="2023. 2. 25. 오후 4:55:02">2023-02-25</time>&nbsp;게시 됨</span><span class="level-item"><time datetime="2023-06-10T11:48:35.465Z" title="2023. 6. 10. 오후 8:48:35">2023-06-10</time>&nbsp;업데이트 됨</span><span class="level-item"><a class="link-muted" href="/categories/book/">book</a><span> / </span><a class="link-muted" href="/categories/book/clean-architecture/">clean-architecture</a></span><span class="level-item">12분안에 읽기 (약 1848 단어)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/02/25/book/clean-architecture/clean-1/">1. 계층형 아키텍처의 문제는 무엇일까?</a></h1><div class="content"><h2 id="계층형-아키텍처란">계층형 아키텍처란?</h2>
<p>계층(layer)으로 구성된 (웹) 애플리케이션은 전통적인 웹 애플리케이션 구조를 말한다.</p>
<p>크게보면 웹 → 도메인 → 영속성 으로 구성된 3계층으로 많이 표현되는데</p>
<ul>
<li>웹 : 요청을 받아서 서비스로 요청을 보냄</li>
<li>도메인(비즈니스) : 필요한 비즈니스 로직을 수행하고 엔티티의 현재 상태를 조회하거나 변경하기 위해 영속성 계층의 컴포넌트 호출</li>
<li>영속성 : 엔티티, 리포지터리 등 데이터베이스 관련 컴포넌트</li>
</ul>
<p>오랫동안 사용한만큼 견고한 아키텍처 패턴이 맞고 잘 이해하고 사용하면 각 계층에 독립적으로 로직을 작성하고 기존 기능에 영향없는 기능 추가도 가능하다.</p>
<p>다만, 계층형은 코드에 나쁜 습관들이 스며들기 쉽고 시간이 지날수록 유지보수가 힘들어지는 단점들이 있다.</p>
<h3 id="계층형-아키텍처는-데이터베이스-주도-설계를-유도한다">계층형 아키텍처는 데이터베이스 주도 설계를 유도한다.</h3>
<p>계층형의 토대는 데이터베이스라서 웹은 도메인을, 도메인은 영속성을 의존하다보니 모두 데이터베이스에  의존하게 된다.</p>
<p>보통 애플리케이션을 만들때 비즈니스를 관장하는 규칙이나 정책을 반영한 모델을 만드는데 이때 우리는 상태(state)가 아니라 행동(behavior)을 중심으로 모델링한다.</p>
<p>하지만 계층형의 설계는 보통 데이터베이스를 토대로 도메인 로직을 구현하는 방식이라서 아키텍처의 구현으로는 맞더라도 비즈니스 관점에선 다르다.</p>
<p>가장 중요한 도메인 로직을 먼저 만들어야 로직을 제대로 이해하는지 확인하고 이를 토대로 웹과 영속성 계층을 설계할 수 있기 때문이다.</p>
<p>ORM(object-relational-mapping, 객체 관계매핑) 프레임워크(JPA, 하이버네이트 등)를 사용하면 비즈니스 규칙을 영속성 관점에 섞고 싶은 생각이 들게 된다.</p>
<p>ORM에 의해 관리되는 엔티티들은 일반적으로 영속성 계층에 두고 도메인계층에선 엔티티에 접근가능한데 이러한 구조는 영속성 계층과 도메인 계층 사이에 강한 결합을 만들게 된다.</p>
<p>서비스에서 영속성 모델을 마치 비즈니스 모델처럼 사용하다보면 도메인 로직뿐만 아니라 영속성 계층과 관련된 작업들도 해줘야 한다.</p>
<p>영속성 코드가 사실상 도메인 코드에 녹아들면서 둘 중 하나만 바꾸는게 어려워져서 계층형의 목표와 대치되는 코드가 된다.</p>
<h2 id="지름길을-택하기-쉬워진다">지름길을 택하기 쉬워진다.</h2>
<p>계층형 아키텍처는 특정한 계층에서는 같은 계층에 있는 컴포넌트나 아래에 있는 계층에만 접근 가능하다는 규칙이 있다.</p>
<p>만약 상위 계층에 위치한 컴포넌트에 접근해야 한다면? 컴포넌트를 계층 아래로 내려버리면 된다. 한번은 괜찮을 수 있다. 근데 2번, 3번이 넘고 나 뿐만 아니라 다른 동료들도 그렇게 하게 되면?</p>
<p>유틸리티나 헬퍼 컴포넌트 등이 아래 계층으로 내려오게 되면 영속성 계층은 모든 것에 접근 가능하기 때문에 시간이 지날 수록 점점 비대해 질 것이다.</p>
<h3 id="테스트하기-어려워진다">테스트하기 어려워진다.</h3>
<p>계층형 아키텍처에서 계층을 건너뛰도록 하는 경우도 있다. 엔티티의 필드를 딱 하나만 조작하면 될 경우에 웹 계층에서 바로 영속성 계층에 접근하면 도메인 계층을 건너 뛰게 된다. 이런 경우 크게 두가지 문제가 발생하는데</p>
<ol>
<li>도메인 로직을 웹 계층에 구현하게 된다.<br>
만약 유스케이스가 확장된다면 더 많은 도메인 로직이 웹 계층에 추가되면서 애플리케이션 전반으로 책임이 섞이고 핵심 도메인 로직들이 퍼져나갈 수 있다.</li>
<li>웹 계층 테스트에서 도메인 계층뿐만 아니라 영속성 계층도 모킹(mocking)해야 한다.<br>
이 경우 단위 테스트의 복잡도가 올라가고 이렇게 복잡한 설정을 할 시간이 없어서 테스트를 안하게 되는 시작이 된다.</li>
</ol>
<h3 id="유스케이스를-숨긴다">유스케이스를 숨긴다.</h3>
<p>기능을 추가하거나 변경할 적절한 위치를 찾는 일이 빈번하기 때문에 ㅐ아키텍처는 코드를 빠르게 탐색하는데 도움이 돼야 한다.</p>
<p>계층형 아키텍처에서는 도메인 로직이 여러 계층에 걸쳐 흩어지기 쉬운 환경이라 유스케이스가 “간단”해서 도메인 계층을 생략하면 웹 계층에 존재할 수도 있고, 도메인과 영속성 모두에 접근할 수 있도록 컴포넌트의 계층을 내리면 영속성 계층에 존재할 수도 있다.</p>
<p>이런 경우 새로운 기능을 추가할 적당한 위치를 찾기 어려워지고 여러 개의 유스케이스를 담당하는 아주 넓은 서비스가 만들어질 수도 있다.</p>
<p>넓은 서비스는 영속성 계층에 많은 의존성을 갖게되고, 웹 레이어의 많은 컴포넌트가 이 서비스에 의존하게 된다. 서비스는 점점 더 복잡해지고 테스트하기도 어려워진다.</p>
<h3 id="동시-작업이-어려워진다">동시 작업이 어려워진다.</h3>
<p>새로운 기능을 추가하기 위해 3명의 개발자가 있을때 각 계층에 각각의 기능을 동시에 개발할 수 있을까?</p>
<p>계층형에선 영속성 계층 위에 모든 것이 만들어지기 때문에 영속성 계층을 먼저 개발ㄹ해야 하고, 그 다음에 도메인 계층, 웹 계층을 만들어야 한다.</p>
<p>동시에 한꺼번에가 아니라 한번에 한명의 개발자만 일할 수 있는 것이다.</p>
<p>또한 넓은 서비스가 있다면 서로 다른 기능을 동시에 작업하기 어려운데 병합 충돌(merge conflict)이나 롤백이 필요한 문제가 발생할 수 있다.</p>
<h3 id="유지보수-가능한-소프트웨어를-만드는-데-어떻게-도움이-될까">유지보수 가능한 소프트웨어를 만드는 데 어떻게 도움이 될까?</h3>
<p>올바르게 구축하고 몇 가지 추가적인 규칙들을 잘 적용한다면 계층형 아키텍처는 유지보수하기 매우 쉬워지며 코드를 쉽게 변경하거나 추가할 수 있다.</p>
<p>하지만 잘못된 방향으로 흘러가기 쉽다보니 계층형 아키텍처로 만들든 다른 아키텍처 스타일로 만들든, 지름길을 택하지 않고 유지보수하기에 더 쉬운 솔루션을 만드는 데 도움이될 것이다.</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time datetime="2023-02-14T06:27:21.000Z" title="2023. 2. 14. 오후 3:27:21">2023-02-14</time>&nbsp;게시 됨</span><span class="level-item"><time datetime="2023-06-13T12:18:13.806Z" title="2023. 6. 13. 오후 9:18:13">2023-06-13</time>&nbsp;업데이트 됨</span><span class="level-item"><a class="link-muted" href="/categories/spring/">spring</a><span> / </span><a class="link-muted" href="/categories/spring/WebFlux/">WebFlux</a></span><span class="level-item">9분안에 읽기 (약 1284 단어)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/02/14/spring/WebFlux/spring-webflux-2/">[WebFlux] Flux와 Stream의 reduce, 그리고 chatGPT</a></h1><div class="content"><p>평소처럼 개발하던 중 reduce를 사용한 코드에서 오류가 발생했다.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">java: cannot find symbol</span><br><span class="line">  symbol: variable accumulatedMap</span><br><span class="line"></span><br><span class="line">java: cannot find symbol</span><br><span class="line">  symbol: variable currentMap</span><br></pre></td></tr></table></figure>
<p>오류가 발생한 상황을 샘플코드로 대략적으로 재현해봤다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// sample 1</span></span><br><span class="line">List&lt;Integer&gt; list = IntStream.range(<span class="number">0</span>,<span class="number">10</span>).boxed().collect(Collectors.toList());</span><br><span class="line"><span class="type">var</span> <span class="variable">collectMap</span> <span class="operator">=</span> list.stream()</span><br><span class="line">        .map(i -&gt; &#123;</span><br><span class="line">            Map&lt;String, Integer&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">            map.put(<span class="string">&quot;key&quot;</span> + i, i * <span class="number">10</span>);</span><br><span class="line">            <span class="keyword">return</span> map;</span><br><span class="line">        &#125;)</span><br><span class="line">        .reduce(**Collections.emptyMap()**, (accumulatedMap, currentMap) -&gt; <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;() &#123;</span><br><span class="line">            &#123;</span><br><span class="line">                putAll(accumulatedMap);</span><br><span class="line">                putAll(currentMap);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">System.out.println(<span class="string">&quot;Stream reduce Map size: &quot;</span> + collectMap.size());</span><br><span class="line"><span class="comment">// Stream reduce Map size: 10</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// sample 2</span></span><br><span class="line">Flux.range(<span class="number">1</span>, <span class="number">10</span>)</span><br><span class="line">        .map(i -&gt; &#123;</span><br><span class="line">            Map&lt;String, Integer&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">            map.put(<span class="string">&quot;key&quot;</span> + i, i * <span class="number">10</span>);</span><br><span class="line">            <span class="keyword">return</span> map;</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="comment">//.reduce(**Collections.emptyMap()** ,(accumulatedMap, currentMap) -&gt; new HashMap&lt;&gt;() &#123; // compile error!! &gt; `java: cannot find symbol`</span></span><br><span class="line">        .reduce((accumulatedMap, currentMap) -&gt; <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;() &#123;</span><br><span class="line">            &#123;</span><br><span class="line">                putAll(accumulatedMap);</span><br><span class="line">                putAll(currentMap);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">        .doOnNext(map -&gt; &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;Flux reduce Map size: &quot;</span> + map.size());</span><br><span class="line">        &#125;)</span><br><span class="line">        .subscribe();</span><br><span class="line"><span class="comment">// Flux reduce Map size: 10</span></span><br></pre></td></tr></table></figure>
<p>Stream과 Flux의 reduce를 호출 시 initial 파라미터로 각각 <code>Collections.emptyMap()</code>를 사용하였으나 Stream은 정상동작하지만 Flux에선 컴파일 오류가 발생하였다.</p>
<p>여러 케이스로 바꿔가면서 테스트를 해보니 Collections.emptyMap()의 반환값이 불변객체라서 안되는거 같다는 추론까진 도달했지만 확신은 없었다.</p>
<p>구글링으로 찾아보려고 했지만 공식문서를 봐도 Flux에선 안되고 Stream에선 되는 이유에 대해서 명확한 답변을 찾기 어려워서 고민하던차에 요즘 핫한 chatGPT에 물어볼까 하는 생각이 들어서 바로 실행해봤다.</p>
<p>아래는 chatGPT 와 대화한 내용</p>
<hr>
<blockquote>
<p>i want <code>public final &lt;A&gt; Mono&lt;A&gt; reduce(A initial, BiFunction&lt;A,? super T,A&gt; accumulator)</code> example code.</p>
</blockquote>
<ul>
<li>
<p>Here’s an example of how you could use the <strong><code>reduce</code></strong> method in Spring WebFlux:</p>
  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> reactor.core.publisher.Flux;</span><br><span class="line"><span class="keyword">import</span> reactor.core.publisher.Mono;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.function.BiFunction;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ReduceExample</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        Flux&lt;Integer&gt; numbers = Flux.just(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>);</span><br><span class="line"></span><br><span class="line">        BiFunction&lt;Integer, Integer, Integer&gt; accumulator = (a, b) -&gt; a + b;</span><br><span class="line">        Mono&lt;Integer&gt; sum = numbers.reduce(<span class="number">0</span>, accumulator);</span><br><span class="line"></span><br><span class="line">        sum.subscribe(result -&gt; System.out.println(<span class="string">&quot;The sum of the numbers is: &quot;</span> + result));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>This example creates a <strong><code>Flux</code></strong> of integers and then uses the <strong><code>reduce</code></strong> method to sum them up. The <strong><code>reduce</code></strong> method takes an initial value, in this case <strong><code>0</code></strong>, and a <strong><code>BiFunction</code></strong> that specifies how the current accumulation (<strong><code>a</code></strong>) is combined with each element from the flux (<strong><code>b</code></strong>) to produce the next accumulation.<br>
The <strong><code>subscribe</code></strong> method is then used to subscribe to the <strong><code>Mono</code></strong> returned by <strong><code>reduce</code></strong> and print out the result.</p>
</li>
</ul>
<blockquote>
<p>initial Type is HashMap</p>
</blockquote>
<ul>
<li>
<p>Here’s an example of how you could use the <strong><code>reduce</code></strong> method with an initial value of a <strong><code>HashMap</code></strong>:</p>
  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> reactor.core.publisher.Flux;</span><br><span class="line"><span class="keyword">import</span> reactor.core.publisher.Mono;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.function.BiFunction;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ReduceExample</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        Flux&lt;String&gt; words = Flux.just(<span class="string">&quot;apple&quot;</span>, <span class="string">&quot;banana&quot;</span>, <span class="string">&quot;cherry&quot;</span>, <span class="string">&quot;apple&quot;</span>, <span class="string">&quot;banana&quot;</span>);</span><br><span class="line"></span><br><span class="line">        BiFunction&lt;HashMap&lt;String, Integer&gt;, String, HashMap&lt;String, Integer&gt;&gt; accumulator = (map, word) -&gt; &#123;</span><br><span class="line">            <span class="keyword">if</span> (!map.containsKey(word)) &#123;</span><br><span class="line">                map.put(word, <span class="number">1</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                map.put(word, map.get(word) + <span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> map;</span><br><span class="line">        &#125;;</span><br><span class="line">        Mono&lt;HashMap&lt;String, Integer&gt;&gt; wordCounts = words.reduce(<span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;(), accumulator);</span><br><span class="line"></span><br><span class="line">        wordCounts.subscribe(result -&gt; System.out.println(<span class="string">&quot;The word counts are: &quot;</span> + result));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>This example creates a <strong><code>Flux</code></strong> of strings and uses the <strong><code>reduce</code></strong> method to count the occurrences of each word. The <strong><code>reduce</code></strong> method takes an initial value, in this case a new empty <strong><code>HashMap</code></strong>, and a <strong><code>BiFunction</code></strong> that specifies how the current <strong><code>HashMap</code></strong> (<strong><code>map</code></strong>) is combined with each word from the flux (<strong><code>word</code></strong>) to produce the next <strong><code>HashMap</code></strong>.<br>
The <strong><code>subscribe</code></strong> method is then used to subscribe to the <strong><code>Mono</code></strong> returned by <strong><code>reduce</code></strong> and print out the result.</p>
</li>
</ul>
<blockquote>
<p>Why does <code>Mono&lt;HashMap&lt;String, Integer&gt;&gt; wordCounts = words.reduce(Collections.emptyMap(), accumulator);</code> error occur?</p>
</blockquote>
<ul>
<li>
<p>The error occurs because <strong><code>Collections.emptyMap()</code></strong> returns an unmodifiable map, which means you can’t modify it. The <strong><code>reduce</code></strong> method expects the accumulator function to modify the accumulator object, which is not possible with an unmodifiable map.<br>
You can resolve the issue by creating a new empty <strong><code>HashMap</code></strong> as the initial value instead of using <strong><code>Collections.emptyMap()</code></strong>, like this:</p>
  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Mono&lt;HashMap&lt;String, Integer&gt;&gt; wordCounts = words.reduce(<span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;(), accumulator);</span><br></pre></td></tr></table></figure>
<p>This will give you a modifiable map that can be updated by the accumulator function as required by the <strong><code>reduce</code></strong> method.</p>
</li>
</ul>
<blockquote>
<p>But why does Java Stream API succeed?</p>
</blockquote>
<ul>
<li>The Java Stream API allows you to use the <strong><code>reduce</code></strong> method with an initial value of <strong><code>Collections.emptyMap()</code></strong> because the <strong><code>reduce</code></strong> operation in the Stream API operates on an internal data structure that is separate from the original data source. This allows the Stream API to handle unmodifiable maps as the initial value without any issues.<br>
However, in reactive programming with Spring WebFlux, the <strong><code>reduce</code></strong> method operates on the data stream directly, so you need to provide an accumulator object that is mutable. That’s why you need to use a new empty <strong><code>HashMap</code></strong> instead of <strong><code>Collections.emptyMap()</code></strong> as the initial value.</li>
</ul>
<hr>
<p>별로 기대하지 않았는데 원하는 내용에 대해서 생각보다 정확한 답변을 들을 수 있었다.</p>
<ol>
<li>먼저 Flux의 reduce 호출 시<code>initial</code>가 HashMap인 케이스로 샘플코드를 요청하고 Collections.emptyMap() 을 초기값으로 사용 시 왜 오류가 나는지 물어봤고<br>
Collections.emptyMap()으로 생성되는 객체는 returns an unmodifiable map 즉, immutable(불변)객체인데 reduce 메서드는 초기값으로 들어온 accumulator 객체를 수정할 것으로 예상했지만 수정이 불가능한 불변객체가 들어와서 오류가 발생하는거라고 한다.</li>
<li>Stream의 reduce에선 왜 성공하는지? 에 대해선<br>
Stream의 reduce는 원래 데이터와는 다른 별도의 내부 데이터 구조에서 동작하기 때문에 Collections.emptyMap()의 초기값으로 reduce를 사용할 수 있지만<br>
리액티브 프로그래밍 기반의 WebFlux에선 데이터 스트림에서 reduce 메서드가 직접 동작하기 때문에 변경가능한 accumulator 객체를  제공해야 하므로 변경이 가능한 빈 HashMap 객체를 생성해야 한다고 답변하였다.</li>
</ol>
<p>앞으로 나의 코딩선생님이 하나 더 늘었다는 생각에 흥분되면서도 한편으론 chatGPT를 사용해서 구글의 코딩인터뷰 Level3도 통과했다는 뉴스처럼 문맥을 파악해서 의도한 바를 정확하게 알려주는 답변을 보고 소름이 돋았다.</p>
</div></article></div><nav class="pagination" role="navigation" aria-label="pagination"><div class="pagination-previous"><a href="/page/3/">이전</a></div><div class="pagination-next"><a href="/page/5/">다음</a></div><ul class="pagination-list is-hidden-mobile"><li><a class="pagination-link" href="/">1</a></li><li><a class="pagination-link" href="/page/2/">2</a></li><li><a class="pagination-link" href="/page/3/">3</a></li><li><a class="pagination-link is-current" href="/page/4/">4</a></li><li><a class="pagination-link" href="/page/5/">5</a></li><li><span class="pagination-ellipsis">&hellip;</span></li><li><a class="pagination-link" href="/page/10/">10</a></li></ul></nav></div><div class="column column-left is-3-tablet is-3-desktop is-3-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="/img/avatar.png" alt="Jaeyong Yoo"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Jaeyong Yoo</p><p class="is-size-6 is-block">Backend Developer</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Seoul, Korea</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">포스트</p><a href="/archives"><p class="title">46</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">카테고리</p><a href="/categories"><p class="title">18</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">태그</p><a href="/tags"><p class="title">19</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/yoo0926" target="_blank" rel="external nofollow noopener noreferrer">팔로우</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="external nofollow noopener noreferrer" title="Github" href="https://github.com/yoo0926"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="external nofollow noopener noreferrer" title="Mail" href="mailto:wodydasktp@gmail.com"><i class="far fa-envelope"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/rss2.xml"><i class="fas fa-rss"></i></a></div></div></div><!--!--><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">카테고리</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/algorithm/"><span class="level-start"><span class="level-item">algorithm</span></span><span class="level-end"><span class="level-item tag">3</span></span></a><ul><li><a class="level is-mobile" href="/categories/algorithm/programmers/"><span class="level-start"><span class="level-item">programmers</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/blog/"><span class="level-start"><span class="level-item">blog</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/book/"><span class="level-start"><span class="level-item">book</span></span><span class="level-end"><span class="level-item tag">21</span></span></a><ul><li><a class="level is-mobile" href="/categories/book/clean-architecture/"><span class="level-start"><span class="level-item">clean-architecture</span></span><span class="level-end"><span class="level-item tag">11</span></span></a></li><li><a class="level is-mobile" href="/categories/book/spring5-reactive/"><span class="level-start"><span class="level-item">spring5-reactive</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/categories/book/springboot-aws-webservice/"><span class="level-start"><span class="level-item">springboot-aws-webservice</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/docker/"><span class="level-start"><span class="level-item">docker</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/etc/"><span class="level-start"><span class="level-item">etc</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/functional/"><span class="level-start"><span class="level-item">functional</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/git/"><span class="level-start"><span class="level-item">git</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/interview/"><span class="level-start"><span class="level-item">interview</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/java/"><span class="level-start"><span class="level-item">java</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/spring/"><span class="level-start"><span class="level-item">spring</span></span><span class="level-end"><span class="level-item tag">7</span></span></a><ul><li><a class="level is-mobile" href="/categories/spring/WebFlux/"><span class="level-start"><span class="level-item">WebFlux</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/sql/"><span class="level-start"><span class="level-item">sql</span></span><span class="level-end"><span class="level-item tag">1</span></span></a><ul><li><a class="level is-mobile" href="/categories/sql/postgresql/"><span class="level-start"><span class="level-item">postgresql</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/web/"><span class="level-start"><span class="level-item">web</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">최근 글</h3><article class="media"><div class="media-content"><p class="date"><time datetime="2023-06-16T11:55:27.000Z">2023-06-16</time></p><p class="title"><a href="/2023/06/16/spring/spring-3/">Spring Event와 ApplicationEventPublisher</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time datetime="2023-06-15T11:23:11.000Z">2023-06-15</time></p><p class="title"><a href="/2023/06/15/spring/spring-2/">ThreadLocal과 Netty</a></p><p class="categories"><a href="/categories/spring/">spring</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time datetime="2023-06-14T10:37:34.000Z">2023-06-14</time></p><p class="title"><a href="/2023/06/14/java/java-01/">Java Enum을 활용해보기</a></p><p class="categories"><a href="/categories/java/">java</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time datetime="2023-06-13T11:57:35.000Z">2023-06-13</time></p><p class="title"><a href="/2023/06/13/spring/WebFlux/spring-webflux-4/">[WebFlux] map과 flatMap에 대해서</a></p><p class="categories"><a href="/categories/spring/">spring</a> / <a href="/categories/spring/WebFlux/">WebFlux</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time datetime="2023-05-21T05:13:38.000Z">2023-05-21</time></p><p class="title"><a href="/2023/05/21/blog/hexo-upgrade/">Hexo 버전 업그레이드, 경고 지우기</a></p><p class="categories"><a href="/categories/blog/">blog</a></p></div></article></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">아카이브</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2023/06/"><span class="level-start"><span class="level-item">6월 2023</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/05/"><span class="level-start"><span class="level-item">5월 2023</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/04/"><span class="level-start"><span class="level-item">4월 2023</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/03/"><span class="level-start"><span class="level-item">3월 2023</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/02/"><span class="level-start"><span class="level-item">2월 2023</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/01/"><span class="level-start"><span class="level-item">1월 2023</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/01/"><span class="level-start"><span class="level-item">1월 2022</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/12/"><span class="level-start"><span class="level-item">12월 2021</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/11/"><span class="level-start"><span class="level-item">11월 2021</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/09/"><span class="level-start"><span class="level-item">9월 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/08/"><span class="level-start"><span class="level-item">8월 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/06/"><span class="level-start"><span class="level-item">6월 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/05/"><span class="level-start"><span class="level-item">5월 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/04/"><span class="level-start"><span class="level-item">4월 2021</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/12/"><span class="level-start"><span class="level-item">12월 2020</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/11/"><span class="level-start"><span class="level-item">11월 2020</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">태그</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/JWT/"><span class="tag">JWT</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/algorithm/"><span class="tag">algorithm</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/blog/"><span class="tag">blog</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/book/"><span class="tag">book</span><span class="tag">21</span></a></div><div class="control"><a class="tags has-addons" href="/tags/docker/"><span class="tag">docker</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/functional/"><span class="tag">functional</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/git/"><span class="tag">git</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/googleTagManager/"><span class="tag">googleTagManager</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/hexo/"><span class="tag">hexo</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/interview/"><span class="tag">interview</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/java/"><span class="tag">java</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/kakao/"><span class="tag">kakao</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/kakaotalk/"><span class="tag">kakaotalk</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/open-graph/"><span class="tag">open graph</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/postgresql/"><span class="tag">postgresql</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/programmers/"><span class="tag">programmers</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/spring/"><span class="tag">spring</span><span class="tag">17</span></a></div><div class="control"><a class="tags has-addons" href="/tags/sql/"><span class="tag">sql</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/web/"><span class="tag">web</span><span class="tag">1</span></a></div></div></div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">업데이트 소식 받기</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="구독"></div></div></form></div></div></div><div class="card widget"><div class="card-content"><div class="notification is-danger">You need to set <code>client_id</code> and <code>slot_id</code> to show this AD unit. Please set it in <code>_config.yml</code>.</div></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo-header.png" alt="하루하루 끄적끄적" height="28"></a><p class="is-size-7"><span>&copy; 2023 Jaeyong Yoo</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="external nofollow noopener noreferrer">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="external nofollow noopener noreferrer">Icarus</a><br><span id="busuanzi_container_site_uv"><span id="busuanzi_value_site_uv">0</span>명의 사용자가 방문 함</span></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="external nofollow noopener noreferrer" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="external nofollow noopener noreferrer" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="external nofollow noopener noreferrer" title="Download on GitHub" href="https://github.com/yoo0926/yoo0926.github.io"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("ko");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="맨 위로" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "이 웹 사이트는 귀하의 경험을 향상시키기 위해 Cookie를 사용합니다.",
          dismiss: "무시",
          allow: "허용",
          deny: "거부",
          link: "더 알아보기",
          policy: "Cookie 정책",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="입력 하세요..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"입력 하세요...","untitled":"(제목 없음)","posts":"포스트","pages":"페이지","categories":"카테고리","tags":"태그"});
        });</script></body></html>