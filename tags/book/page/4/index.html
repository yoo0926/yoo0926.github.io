<!doctype html>
<html lang="ko"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="naver-site-verification" content="ab9573df103dfc4dfc214b8015c103cf14d9fcce"><meta name="robots" content="noindex"><meta><title>태그: book - 하루하루 끄적끄적</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="하루하루 끄적끄적"><meta name="msapplication-TileImage" content="/img/favicon.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="하루하루 끄적끄적"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="티끌모아 태산이라 티끌부터 모아본다."><meta property="og:type" content="blog"><meta property="og:title" content="하루하루 끄적끄적"><meta property="og:url" content="https://yoo0926.github.io/"><meta property="og:site_name" content="하루하루 끄적끄적"><meta property="og:description" content="티끌모아 태산이라 티끌부터 모아본다."><meta property="og:locale" content="ko_KR"><meta property="og:image" content="https://yoo0926.github.io/img/og_image.png"><meta property="article:author" content="Jaeyong Yoo"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://yoo0926.github.io"},"headline":"하루하루 끄적끄적","image":["https://yoo0926.github.io/img/og_image.png"],"author":{"@type":"Person","name":"Jaeyong Yoo"},"publisher":{"@type":"Organization","name":"하루하루 끄적끄적","logo":{"@type":"ImageObject","url":"https://yoo0926.github.io/img/logo-header.png"}},"description":"티끌모아 태산이라 티끌부터 모아본다."}</script><link rel="icon" href="/img/favicon.png"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.2/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><script src="https://www.googletagmanager.com/gtag/js?id=G-EKSGRQ3VMZ" async></script><script>window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
    
        gtag('config', 'G-EKSGRQ3VMZ');</script><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><!--!--><!--!--><script data-ad-client="ca-pub-4055492668550708" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js" async></script><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/rss2.xml" title="하루하루 끄적끄적" type="application/rss+xml">
</head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo-header.png" alt="하루하루 끄적끄적" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="external nofollow noopener noreferrer" title="Download on GitHub" href="https://github.com/yoo0926/yoo0926.github.io"><i class="fab fa-github"></i></a><a class="navbar-item search" title="검색" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-9-tablet is-9-desktop is-9-widescreen"><div class="card"><div class="card-content"><nav class="breadcrumb" aria-label="breadcrumbs"><ul><li><a href="/tags">태그</a></li><li class="is-active"><a href="#" aria-current="page">book</a></li></ul></nav></div></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time datetime="2021-11-28T09:08:27.000Z" title="2021. 11. 28. 오후 6:08:27">2021-11-28</time>&nbsp;게시 됨</span><span class="level-item"><time datetime="2023-06-10T11:50:46.216Z" title="2023. 6. 10. 오후 8:50:46">2023-06-10</time>&nbsp;업데이트 됨</span><span class="level-item"><a class="link-muted" href="/categories/book/">book</a><span> / </span><a class="link-muted" href="/categories/book/spring5-reactive/">spring5-reactive</a></span><span class="level-item">2분안에 읽기 (약 265 단어)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2021/11/28/book/spring5-reactive/1/">1. 왜 리액티브 스프링인가?</a></h1><div class="content"><p align="center">
  <img src="/img/book/spring5-reactive/book-cover.jpg" width="50%">
</p>
<h2 id="리액티브-반응형-이-필요한-이유">리액티브(반응형)이 필요한 이유</h2>
<ul>
<li>증가하는 요청, 부하에 대해서 높은 응답성을 유지해야 한다.</li>
<li><strong>메시지 기반 통신</strong>을 바탕으로 <strong>탄력성</strong>과 <strong>복원력</strong>을 확보하하여 높은 응답성을 추구한다.</li>
</ul>
<h2 id="탄력성">탄력성</h2>
<ul>
<li>자원을 비례적으로 추가하거나 제거하여 시스템의 처리량의 자동으로 증감 하는 것</li>
</ul>
<h2 id="복원력">복원력</h2>
<ul>
<li>시스템의 실패에도 반응성을 유지하는 것</li>
<li>시스템의 기능 요소를 격리해 모든 내부 장애를 격리하고 독립성을 확보함으로써 달성</li>
</ul>
<h2 id="메시지-기반-통신-Message-driven">메시지 기반 통신(Message-driven)</h2>
<ul>
<li>제한된 리소스의 활용도를 높이기 위해서 비동기 논블로킹 모델을 사용해야 한다.</li>
<li>메시지 브로커를 사용하면 대기열을 모니터링하여 시스템의 부하관리 및 탄력성을 제어할 수 있다.</li>
</ul>
<p><a target="_blank" rel="external nofollow noopener noreferrer" href="https://www.reactivemanifesto.org/ko/glossary">리액티브 선언문(https://www.reactivemanifesto.org/ko/glossary)</a></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time datetime="2021-04-25T09:08:54.000Z" title="2021. 4. 25. 오후 6:08:54">2021-04-25</time>&nbsp;게시 됨</span><span class="level-item"><time datetime="2023-06-10T11:47:48.011Z" title="2023. 6. 10. 오후 8:47:48">2023-06-10</time>&nbsp;업데이트 됨</span><span class="level-item"><a class="link-muted" href="/categories/book/">book</a><span> / </span><a class="link-muted" href="/categories/book/springboot-aws-webservice/">springboot-aws-webservice</a></span><span class="level-item">2분안에 읽기 (약 331 단어)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2021/04/25/book/springboot-aws-webservice/5/">5.중간메모</a></h1><div class="content"><p>복습 겸 다시 프로젝트 생성해서 만들어보다가 몇가지 간략히 정리</p>
<h2 id="1-springboot에서-html파일을-templates에서-읽도록-하기">1. springboot에서 html파일을 templates에서 읽도록 하기</h2>
<p>템플릿 엔진과 관련된 의존성을 추가하면 자동으로 <code>/recourses/templates</code> 아래에서 템플릿 파일을 찾도록 하는거 같은데 원래 기본 경로는 <code>/recourses/static</code> 이다.</p>
<p>따라서 별다른 설정을 하지 않고 html 파일을 templates 폴더 밑에 놓고 찾으려고 하면 당연히 404 에러를 볼수 밖에 없다.</p>
<p>html 파일을 templates 아래에 관리하고 싶다면 몇가지 작업을 해야하는데</p>
<p>우선 스프링부트에서 WebMVC 설정을 유지하면서 기능을 확장하기 위해 <code>WebMvcConfigurer</code>를 <code>implements</code> 하고 <code>addResourceHandlers</code> 를 오버라이드하여 아래와 같이 작성한다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequiredArgsConstructor</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WebConfig</span> <span class="keyword">implements</span> <span class="title class_">WebMvcConfigurer</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addResourceHandlers</span><span class="params">(ResourceHandlerRegistry registry)</span> &#123;</span><br><span class="line">        registry.addResourceHandler(<span class="string">&quot;/**&quot;</span>)</span><br><span class="line">                .addResourceLocations(<span class="string">&quot;classpath:/templates/&quot;</span>)</span><br><span class="line">                .setCacheControl(CacheControl.maxAge(<span class="number">10</span>, TimeUnit.MINUTES));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="2-application-properties-application-yml-변환">2. application.properties -&gt; application.yml 변환</h2>
<p>가독성 측면에서 yaml 파일이 더 좋아보여서 기존 내용을 변환해서 쓰려다보니 naver oauth2 설정을 하면 오류가 발생한다.</p>
<p><code>redirect-uri: '&#123;baseUrl&#125;/&#123;action&#125;/oauth2/code/&#123;registrationId&#125;'</code></p>
<p>yaml 에서는 / (슬러시)를 그대로 쓰면 파싱 에러가 난다. 따옴표나 작은 따옴표로 감싸주면 된다.</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time datetime="2021-04-22T09:08:51.000Z" title="2021. 4. 22. 오후 6:08:51">2021-04-22</time>&nbsp;게시 됨</span><span class="level-item"><time datetime="2023-06-10T11:47:48.018Z" title="2023. 6. 10. 오후 8:47:48">2023-06-10</time>&nbsp;업데이트 됨</span><span class="level-item"><a class="link-muted" href="/categories/book/">book</a><span> / </span><a class="link-muted" href="/categories/book/springboot-aws-webservice/">springboot-aws-webservice</a></span><span class="level-item">8분안에 읽기 (약 1253 단어)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2021/04/22/book/springboot-aws-webservice/4/">4.머스테치로 화면 구성하기</a></h1><div class="content"><h1>4. 머스테치로 화면 구성하기</h1>
<h2 id="4-1-서버-템플릿-엔진">4.1 서버 템플릿 엔진</h2>
<p>템플릿 엔진이란, <strong>지정된 템플릿 양식과 데이터</strong>가 합쳐져 HTML문서를 출력하는 소프트웨어를 이야기한다.</p>
<p>서버 템플릿 엔진을 이용한 화면 생성은 서버에서 Java 코드로 문자열을 만든 뒤 이 문자열을 HTML로 변환하여 브라우저로 전달한다.</p>
<p>반면 클라이언트 템플릿 엔진(Vue, React 등)을 이용한 SPA(Single Page Application)은 브라우저에서 화면을 생성한다. 즉, 서버에서 이미 코드가 벗어난 경우라서</p>
<p>서버에서는 Json 혹은 Xml 형식의 데이터만 전달하고 클라이언트에서 조립한다.</p>
<p>최근엔 리액트나 뷰와 같은 자바스크립트 프레임워크에서 서버사이드렌더링을 지원하는 모습을 볼 수 있지만 그건 나중에 생각하자.</p>
<hr>
<h3 id="머스테치">머스테치</h3>
<p>머스테치는 많은 언어를 지원하는 심플한 템플릿 엔진이다.</p>
<p>스프링 부트에서 공식 지원하는 템플릿 엔진으로 gradle에 의존성 한줄 추가하면 바로 사용할 수 있다.</p>
<p>파일위치는 기본적으로 <code>src/main/resources/templates</code>이며 이 위치에 머스테치 파일을 두면 스프링 부트에서 자동으로 로딩한다.</p>
<p>해당 위치에 index.mustache를 생성한 후 이 머스테치에 URL을 매핑하는데 이는 Controller에서 진행한다.</p>
<ul>
<li>IndexController</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.GetMapping;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">IndexController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">index</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;index&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>머스테치 스타터 의존성을 추가했기 때문에 컨트롤러에서 문자열을 반환할 때 <strong>앞의 경로와 뒤의 파일 확장자는 자동으로 지정</strong>된다.</p>
<p>즉, 여기선 &quot;index&quot;를 반환하므로 <code>src/main/resources/templates/index.mustache</code>로 전환되어 <strong>View Resolver</strong>가 처리하게 된다.</p>
<p>(View Resolver는 URL 요청의 결과를 전달할 타입과 값을 지정하는 관리자 격으로 볼 수 있다.)</p>
<hr>
<p>화면 구성 시 bootstrap을 사용하는데 공통된 부분에 대해선 layout을 따로 둬서 header와 footer 파일을 각각 만들어서 공통된 코드는 해당 위치에 생성한다.</p>
<p>여기서 <strong>페이지 로딩속도를 높이기 위해</strong> css는 header에, js는 footer에 두는데 HTML은 위에서부터 코드가 실행되기 때문에 head가 다 실행되고서야 body가 실행된다.</p>
<p>즉, head가 다 불러지지 않으면 사용자 쪽에선 백지 화면만 노출되며 특히 js의 용량이 크면 클수록 body 부분의 실행이 늦어지기 때문에 js는 body 하단에 두어 화면이 다 그려진 뒤에 호출하는 것이 좋다.</p>
<p>header와 footer를 index에 추가하는건 아래와 같다.</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;&gt;layout/header&#125;&#125;</span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>스프링 부트로 시작하는 웹 서비스<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;col-md-12&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;row&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;col-md-6&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;/posts/save&quot;</span> <span class="attr">role</span>=<span class="string">&quot;button&quot;</span> <span class="attr">clas</span>=<span class="string">&quot;btn btn-primary&quot;</span>&gt;</span>글 등록<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">&#123;&#123;&gt;layout/footer&#125;&#125;</span><br></pre></td></tr></table></figure>
<p><code>&#123;&#123;> &#125;&#125;</code> 는 현재 머스테치 파일을 기준으로 다른 파일을 가져온다.</p>
<p>화면의 버튼에 API를 호출하는 js파일을 작성하여 footer.mustache에 추가한다.</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://code.jquery.com/jquery-3.3.1.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--index.js 추가--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;/js/app/index.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>index.js 호출 코드는 절대경로(/)로 바로 시작하는데 스프링 부트는 기본적으로 <code>src/main/resources/static</code>에 위치한 자바스크립트, CSS, 이미지 등 정적 파일들은 URL에서 / 로 설정된다.</p>
<hr>
<ul>
<li>PostsRepository 인터페이스</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">PostsRepository</span> <span class="keyword">extends</span> <span class="title class_">JpaRepository</span>&lt;Posts, Long&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Query(&quot;SELECT p FROM Posts p ORDER BY p.id DESC&quot;)</span></span><br><span class="line">    List&lt;Posts&gt; <span class="title function_">findAllDesc</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>@Query 어노테이션을 사용하면 SpringDataJpa에서 제공하지 않는 메소드를 쿼리로 직접 작성할 수 있다.</p>
<p>보통 규모가 있는 프로젝트에선 데이터 조회는 FK의 조인, 복잡한 조건 등으로 인해 Entity 클래스만으로 처리가 어려워 조회용 프레임워크를 추가로 사용한다.</p>
<p>대표적 예로 <code>querydsl</code>, jooq, MyBatis 등이 있는데 해당 프레임워크 중 하나로 조회를 하고 그 외 등록/수정/삭제 등은 SpringDataJpa를 통해 진행한다.</p>
<ul>
<li>PostsService</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">    <span class="meta">@Transactional(readOnly = true)</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;PostsListResponseDto&gt; <span class="title function_">findAllDesc</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> postsRepository.findAllDesc().stream().map(PostsListResponseDto::<span class="keyword">new</span>).collect(Collectors.toList());</span><br><span class="line">    &#125;</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>@Transactional 어노테이션에 추가된 readOnly 옵션을 true로 주면 <strong>트랜잭션 범위는 유지</strong>하되, 조회기능만 남겨두어 조회 속도가 개선되기 때문에 등록, 수정, 삭제 기능이 전혀 없는 서비스 메소드에서 사용하는 것을 추천한다.</p>
<hr>
<ul>
<li>IndexController</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequiredArgsConstructor</span></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">IndexController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> PostsService postsService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">index</span><span class="params">(Model model)</span> &#123;</span><br><span class="line">        model.addAttribute(<span class="string">&quot;posts&quot;</span>, postsService.findAllDesc());</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;index&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Model</p>
<ul>
<li>서버 템플릿 엔진에서 사용할 수 있는 객체를 저장할 수 있다.</li>
<li>여기서는 postsService.findAllDesc()로 가져온 결과를 posts로 index.mustache에 전달한다.</li>
</ul>
<hr>
<p>REST에서 CURD는 다음과 같이 HTTP Method에 매핑된다.</p>
<ul>
<li>생성(Create) : POST</li>
<li>읽기(Read) : GET</li>
<li>수정(Update) : PUT</li>
<li>삭제(Delete) : DELETE</li>
</ul>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time datetime="2021-04-22T09:08:48.000Z" title="2021. 4. 22. 오후 6:08:48">2021-04-22</time>&nbsp;게시 됨</span><span class="level-item"><time datetime="2023-06-10T11:47:48.028Z" title="2023. 6. 10. 오후 8:47:48">2023-06-10</time>&nbsp;업데이트 됨</span><span class="level-item"><a class="link-muted" href="/categories/book/">book</a><span> / </span><a class="link-muted" href="/categories/book/springboot-aws-webservice/">springboot-aws-webservice</a></span><span class="level-item">20분안에 읽기 (약 2994 단어)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2021/04/22/book/springboot-aws-webservice/3/">3.JPA로 데이터베이스 다루기</a></h1><div class="content"><h2 id="3-JPA">3 JPA</h2>
<p>Posts 클래스는 실제 DB의 테이블과 매칭될 클래스로 <code>Entity 클래스</code>라고 부른다.</p>
<p>DB데이터에 작업할 경우 실제 쿼리를 날리기 보단 이 Entity 클래스의 수정을 통해 작업</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.jojoldu.book.springboot.domain.posts;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.Builder;</span><br><span class="line"><span class="keyword">import</span> lombok.Getter;</span><br><span class="line"><span class="keyword">import</span> lombok.NoArgsConstructor;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.persistence.*;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">1. @Entity</span></span><br><span class="line"><span class="comment">- 테이블과 링크될 클래스</span></span><br><span class="line"><span class="comment">- 기본값으로 클래스의 카멜케이스 이름을 언더스코어 네이밍(_)으로 테이블 이름을 매칭한다.</span></span><br><span class="line"><span class="comment">- ex) SalesManager.java -&gt; sales_manager table</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">아래 3개는 lombok 어노테이션</span></span><br><span class="line"><span class="comment">2. @NoArgsConstructor</span></span><br><span class="line"><span class="comment">- 기본생성자 자동추가</span></span><br><span class="line"><span class="comment">- public Posts() &#123;&#125; 와 같음</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">3. @Getter</span></span><br><span class="line"><span class="comment">- 클래스 내 모든 필드의 Getter 메소드 자동생성</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">4. @Builder</span></span><br><span class="line"><span class="comment">- 해당 클래스의 빌더 패턴 클래스를 생성</span></span><br><span class="line"><span class="comment">- 생성자 상단에 선언 시 생성자에 포함된 필드만 빌더에 포함</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@Getter</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Posts</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    1. @Id</span></span><br><span class="line"><span class="comment">    - PK 필드</span></span><br><span class="line"><span class="comment">    2. @GeneratedValue</span></span><br><span class="line"><span class="comment">    - PK 생성규칙</span></span><br><span class="line"><span class="comment">    - GenerationType.IDENTITY 옵션을 추가해야 auto_increment 된다.</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    <span class="meta">@GeneratedValue(strategy = GenerationType.IDENTITY)</span></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    1. @Column</span></span><br><span class="line"><span class="comment">    - 선언하지 않더라도 해당 클래스의 필드는 모두 컬럼이 된다.</span></span><br><span class="line"><span class="comment">    - 옵션을 추가할 때만 선언해도 된다.</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="meta">@Column(length = 500, nullable = false)</span></span><br><span class="line">    <span class="keyword">private</span> String title;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Column(columnDefinition = &quot;TEXT&quot;, nullable = false)</span></span><br><span class="line">    <span class="keyword">private</span> String content;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String author;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Builder</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Posts</span><span class="params">(String title, String content, String author)</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.title = title;</span><br><span class="line">        <span class="built_in">this</span>.content = content;</span><br><span class="line">        <span class="built_in">this</span>.author = author;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Entity 클래스는 Setter 메소드를 만들지 않고 해당 필드의 값 변경이 필요하면 명확히 그 목적과 의도를 나타낼 수 있는 메소드를 추가해야 한다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Order</span>&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">cancelOrder</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="built_in">this</span>.status = <span class="literal">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> 주문서비스의_취소이벤트() &#123;</span><br><span class="line">  order.cancelOrder();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>기본적인 구조는 <strong>생성자를 통해</strong> 최종값을 채운 후 DB에 삽입하는 것이고 값 변경이 필요하면 해당 이벤트에 맞는 public 메소드를 호출하여 변경하는 것을 전제로 한다.</p>
<p>생성시점에 값을 넣는 방법으로 생성자와 <strong>@Builder</strong>를 통해 제공되는 빌더 클래스를 사용할 수 있는데 차이점이 있다면</p>
<p>생성자는 new Example(b,a)처럼 파라미터의 위치를 바꾸더라도 실제 실행 전까지 문제를 찾기 어렵다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="title function_">Example</span><span class="params">(String a, String b)</span>&#123;</span><br><span class="line">  <span class="built_in">this</span>.a = a;</span><br><span class="line">  <span class="built_in">this</span>.b = b;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>빌더를 사용한다면 어느 필드에 어떤 값을 채워야할 지 명확하게 인지할 수 있다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Example.builder()</span><br><span class="line">  .a(a)</span><br><span class="line">  .b(b)</span><br><span class="line">  .build();</span><br></pre></td></tr></table></figure>
<p>Posts클래스(Entity) 생성이 끝나면 해당 클래스로 Database를 접근하게 해줄 JpaRepository를 생성한다.</p>
<ul>
<li>src/main/java/com/jojoldu/book/springboot/domain/posts/PostsRepository</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.data.jpa.repository.JpaRepository;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">PostsRepository</span> <span class="keyword">extends</span> <span class="title class_">JpaRepository</span>&lt;Posts, Long&gt; &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>보통 ibatis나 MyBatis 등에서 Dao라고 불리는 DB Layer 접근자를 JPA에선 Repository 라고 부르며 인터페이스로 생성한다.</p>
<p>생성 후, <code>JpaRepository&lt;Entity 클래스, PK 타입&gt;</code> 를 상속하면 기본적인 CRUD 메소드가 자동으로 생성된다.</p>
<p>@Repositry 어노테이션을 추가할 필요는 없지만 Entity 클래스와 기본 Entity Repository는 함께 위치해야 한다.</p>
<p>생성한 Repository 를 테스트하기 위해 아래 코드를 작성하며 테스트할 기능은 <strong>save</strong>, <strong>findAll</strong> 기능이다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.jojoldu.book.springboot.domain.posts;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.AfterEach;</span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.Test;</span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.extension.ExtendWith;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.context.junit.jupiter.SpringExtension;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.assertj.core.api.Assertions.assertThat;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">별다른 설정없이 @SpringBootTest를 사용할 경우 H2 데이터베이스를 자동으로 실행한다.</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@ExtendWith(SpringExtension.class)</span></span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PostsRepositoryTest</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    PostsRepository postsRepository;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    1. @AfterEach</span></span><br><span class="line"><span class="comment">    - Junit에서 단위테스트가 끝날 때마다 수행되는 메소드를 지정한다.</span></span><br><span class="line"><span class="comment">    - 보통은 배포 전 전체 테스트를 수행할 때 테스트간 데이터 침범을 막기 위해 사용된다.</span></span><br><span class="line"><span class="comment">    - Junit4 -&gt; 5로 넘어가면서 After -&gt; AfterEach 로 변경되었다.</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="meta">@AfterEach</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">cleanup</span><span class="params">()</span> &#123;</span><br><span class="line">        postsRepository.deleteAll();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> 게시글저장_불러오기() &#123;</span><br><span class="line">        <span class="comment">//given</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">title</span> <span class="operator">=</span> <span class="string">&quot;테스트 게시글&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">content</span> <span class="operator">=</span> <span class="string">&quot;테스트 본문&quot;</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        2. postsRepository.save</span></span><br><span class="line"><span class="comment">        - 테이블 posts에 insert/update 쿼리를 실행한다.</span></span><br><span class="line"><span class="comment">        - id값이 있으면 update, 없다면 insert 쿼리가 실행된다.</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        postsRepository.save(Posts.builder()</span><br><span class="line">                .title(title)</span><br><span class="line">                .content(content)</span><br><span class="line">                .author(<span class="string">&quot;jojoldu@gmail.com&quot;</span>)</span><br><span class="line">                .build());</span><br><span class="line">        </span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        3. postsRepository.findAll</span></span><br><span class="line"><span class="comment">        - 테이블 posts에 있는 모든 데이터를 조회해오는 메소드</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        <span class="comment">//when</span></span><br><span class="line">        List&lt;Posts&gt; postsList = postsRepository.findAll();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//then</span></span><br><span class="line">        <span class="type">Posts</span> <span class="variable">posts</span> <span class="operator">=</span> postsList.get(<span class="number">0</span>);</span><br><span class="line">        assertThat(posts.getTitle()).isEqualTo(title);</span><br><span class="line">        assertThat(posts.getContent()).isEqualTo(content);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="3-4-등록-수정-조회-API-만들기">3.4 등록/수정/조회 API 만들기</h2>
<p>API를 만들기 위해 총 3개의 클래스가 필요하다.</p>
<ul>
<li>Request 데이터를 받을 Dto</li>
<li>API 요청을 받을 Controller</li>
<li>트랜잭션, 도메인 기능 간의 순서를 보장하는 Service</li>
</ul>
<p>여기서 Service는 <strong>비지니스 로직을 처리하는 것이 아니라</strong> 트랜잭션, 도메인 간 순서 보장의 역할만 한다.</p>
<p><strong>Web, Service, Repository, Dto, Domain</strong> 이 5가지 레이어에서 비지니스 처리를 담당해야 할 곳은 **<code>Domain</code>**이다.</p>
<p>기존에 서비스로 처리하던 방식을 <strong>트랜잭션 스크립트</strong>라고 한다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Transactional</span></span><br><span class="line"><span class="keyword">public</span> Order <span class="title function_">cancelOrder</span><span class="params">(<span class="type">int</span> orderId)</span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//1) 데이터베이스로부터 주문정보, 결제정보, 배송정보 조회</span></span><br><span class="line">  <span class="type">OrdersDto</span> <span class="variable">order</span> <span class="operator">=</span> ordersDao.selectOrders(orderId);</span><br><span class="line">  <span class="type">BillingDto</span> <span class="variable">billing</span> <span class="operator">=</span> billingDao.selectBilling(orderId);</span><br><span class="line">  <span class="type">DeliveryDto</span> <span class="variable">delivery</span> <span class="operator">=</span> deliveryDao.selectDelivery(orderId);</span><br><span class="line"></span><br><span class="line">  <span class="comment">//2) 배송 취소를 해야하는지 상태값 확인</span></span><br><span class="line">  <span class="type">String</span> <span class="variable">deliveryStatus</span> <span class="operator">=</span> delivery.getStatus();</span><br><span class="line"></span><br><span class="line">  <span class="comment">//3) 만약 배송중이라면 배송취소로 변경</span></span><br><span class="line">  <span class="keyword">if</span>(<span class="string">&quot;IN_PROGRESS&quot;</span>.equals(deliveryStatus))&#123;</span><br><span class="line">    delivery.setStatus(<span class="string">&quot;CANCEL&quot;</span>);</span><br><span class="line">    deliveryDao.update(delivery);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//4) 각 테이블에 취소 상태 Update</span></span><br><span class="line">  order.setStatus(<span class="string">&quot;CANCEL&quot;</span>);</span><br><span class="line">  orderDao.update(order);</span><br><span class="line"></span><br><span class="line">  billing.setStatus(<span class="string">&quot;CANCEL&quot;</span>);</span><br><span class="line">  deliveryDao.update(billing);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> order;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>모든 로직이 서비스 클래스 내부에서 처리된다면 <strong>서비스 계층이 무의미하며, 객체란 단순히 데이터 덩어리</strong> 역할만 하게 된다.</p>
<p>반면 도메인 모델에서 처리할 경우 아래와 같은 코드가 될 수 있다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Transactional</span></span><br><span class="line">Public Order <span class="title function_">cancelOrder</span><span class="params">(<span class="type">int</span> orderId)</span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//1)</span></span><br><span class="line">  <span class="type">OrdersDto</span> <span class="variable">order</span> <span class="operator">=</span> ordersDao.selectOrders(orderId);</span><br><span class="line">  <span class="type">BillingDto</span> <span class="variable">billing</span> <span class="operator">=</span> billingDao.selectBilling(orderId);</span><br><span class="line">  <span class="type">DeliveryDto</span> <span class="variable">delivery</span> <span class="operator">=</span> deliveryDao.selectDelivery(orderId);</span><br><span class="line"></span><br><span class="line">  <span class="comment">//2-3)</span></span><br><span class="line">  delivery.cancel();</span><br><span class="line"></span><br><span class="line">  <span class="comment">//4)</span></span><br><span class="line">  order.cancel();</span><br><span class="line">  billing.cancel();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> order;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>order, billing, delivery가 각자 본인의 취소 이벤트 처리를 하며, 서비스 메소드는 트랜잭션과 도메인 간의 순서만 보장해 준다.</p>
<hr>
<p>스프링에서 Bean을 주입하는 방식은 다음과 같다.</p>
<ul>
<li>@Autowired</li>
<li>setter</li>
<li>생성자</li>
</ul>
<p>가장 권장하는 방식은 <strong>생성자로 주입</strong>받는 방식이며 @Autowired는 권장하지 않는다.</p>
<p>아래 Service 코드에서 생성자는 직접 쓰지 않고 <strong>@RequiredArgsConstructor</strong>어노테이션에서 해결해 준다.</p>
<p>final이 선언된 모든 필드를 인자값으로 하는 생성자를 롬북에서 대신 생성해준다.</p>
<p>이처럼 어노테이션을 사용하는 이유는 해당 클래스의 의존성 관계가 변경될 때마다 생성자 코드를 변경하는 수고를 덜기 위함이다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.jojoldu.book.springboot.domain.posts.PostsRepository;</span><br><span class="line"><span class="keyword">import</span> com.jojoldu.book.springboot.web.dto.PostsSaveRequestDto;</span><br><span class="line"><span class="keyword">import</span> lombok.RequiredArgsConstructor;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"><span class="keyword">import</span> org.springframework.transaction.annotation.Transactional;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@RequiredArgsConstructor</span></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PostsService</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> PostsRepository postsRepository;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Transactional</span></span><br><span class="line">    <span class="keyword">public</span> Long <span class="title function_">save</span><span class="params">(PostsSaveRequestDto requestDto)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> postsRepository.save(requestDto.toEntity()).getId();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Controller와 Service에서 사용할 Dto 클래스는 언듯 Entity 클래스와 유사한 형태지만 추가로 생성해야한다.</p>
<p>즉, 절대로 Entity 클래스를 Request/Response 클래스로 사용해선 안된다.</p>
<p>이유는 Entity 클래스는 데이터베이스와 맞닿은 핵심 클래스로 화면 변경은 사소한 변경인데 이를 건들기 위해 테이블과 연결된 Entity 클래스를 변경하는 것은 너무 큰 변경이다.</p>
<p>수많은 서비스 클래스나 비즈니스 로직들이 Entity 클래스를 기준으로 동작하며 Entity 클래스가 변경되면 여러 클래스에 영향을 끼지지만</p>
<p>Request/Response 용 Dto는 View를 위한 클래스라 자주 변경이 필요하다.</p>
<p>이처럼 View Layer 와 DB Layer 의 역할을 철저히 분리하는게 좋다.</p>
<p>예를 들어 Controller에서 결과값으로 여러 테이블을 조인해야 하는 경우 Entity 클래스만으로 표현하기 어려운 경우도 있다.</p>
<p>다음은 JPA를 사용한 게시판의 등록 API 테스트 코드이다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.jojoldu.book.springboot.web;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.jojoldu.book.springboot.domain.posts.Posts;</span><br><span class="line"><span class="keyword">import</span> com.jojoldu.book.springboot.domain.posts.PostsRepository;</span><br><span class="line"><span class="keyword">import</span> com.jojoldu.book.springboot.web.dto.PostsSaveRequestDto;</span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.AfterEach;</span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.Test;</span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.extension.ExtendWith;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.web.client.TestRestTemplate;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.web.server.LocalServerPort;</span><br><span class="line"><span class="keyword">import</span> org.springframework.http.HttpStatus;</span><br><span class="line"><span class="keyword">import</span> org.springframework.http.ResponseEntity;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.context.junit.jupiter.SpringExtension;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.assertj.core.api.Assertions.assertThat;</span><br><span class="line"></span><br><span class="line"><span class="meta">@ExtendWith(SpringExtension.class)</span></span><br><span class="line"><span class="meta">@SpringBootTest(webEnvironment = SpringBootTest.WebEnvironment.RANDOM_PORT)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PostsApiControllerTest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@LocalServerPort</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> port;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> TestRestTemplate restTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> PostsRepository postsRepository;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@AfterEach</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">tearDown</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        postsRepository.deleteAll();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> Posts_등록된다() <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="comment">//given</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">title</span> <span class="operator">=</span> <span class="string">&quot;title&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">content</span> <span class="operator">=</span> <span class="string">&quot;content&quot;</span>;</span><br><span class="line">        <span class="type">PostsSaveRequestDto</span> <span class="variable">requestDto</span> <span class="operator">=</span> PostsSaveRequestDto.builder().title(title).content(content).author(<span class="string">&quot;author&quot;</span>).build();</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;http://localhost:&quot;</span> + port + <span class="string">&quot;/api/v1/posts&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//when</span></span><br><span class="line">        ResponseEntity&lt;Long&gt; responseEntity = restTemplate.postForEntity(url, requestDto, Long.class);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//then</span></span><br><span class="line">        assertThat(responseEntity.getStatusCode()).isEqualTo(HttpStatus.OK);</span><br><span class="line">        assertThat(responseEntity.getBody()).isGreaterThan(<span class="number">0L</span>);</span><br><span class="line"></span><br><span class="line">        List&lt;Posts&gt; all = postsRepository.findAll();</span><br><span class="line">        assertThat(all.get(<span class="number">0</span>).getTitle()).isEqualTo(title);</span><br><span class="line">        assertThat(all.get(<span class="number">0</span>).getContent()).isEqualTo(content);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>HelloController와 달리 <code>@WebMvcTest</code>를 사용하지 않는데 @WebMvcTest의 경우 JPA기능이 작동하지 않기 때문인데 Controller와 ControllerAdvice 등 외부 연동과 관련된 부분만 활성화되니</p>
<p>지금 처럼 JPA 기능까지 한번에 테스트할 때는 @SpringBootTest 와 TestRestTemplate을 사용하면 된다.</p>
<hr>
<p>JPA를 사용할 때 update 기능에서 <strong>데이터베이스에 쿼리를 날리는 부분이 없다.</strong><br>
이게 가능한 이유는 JPA의 <strong>영속성 컨텍스트</strong> 때문이다.</p>
<p>영속성 컨텍스트란, <strong>엔티티를 영구 저장하는 환경</strong>으로 일종의 논리적 개념이라고 보면 되며 JPA의 핵심 내용은 엔티티가 영속성 컨텍스트에 포함되어 있냐 아니냐로 갈린다.</p>
<p>JPA의 엔티티 매니저가 활성화된 상태로(Spring Data Jpa를 쓴다면 기본 옵션) <strong>트랜잭션 안에서 데이터베이스에서 데이터를 가져오면</strong> 이 데이터는 영속성 컨텍스트가 유지된 상태이다.</p>
<p>이 상태에서 해당 데이터의 값을 변경하면 <strong>트랜잭션이 끝나는 시점에 해당 테이블에 변경분을 반영</strong>한다. 즉, Entity 객체의 값만 변경하면 별도로 Update쿼리를 날릴 필요가 없는데 이를 <code>더티 체킹(dirty checking)</code>이라고 한다.</p>
<hr>
<h2 id="3-5-JPA-Auditing으로-생성시간-수정시간-자동화하기">3.5 JPA Auditing으로 생성시간/수정시간 자동화하기</h2>
<p>보통 엔티티에는 해당 데이터의 생성시간과 수정시간을 포함하는데 반복적인 코드를 모든 테이블과 서비스 메소드에 포함하면 너무 귀찮으니 JPA Auditing를 사용해보자.</p>
<h3 id="LocalDate-사용">LocalDate 사용</h3>
<p>Java8부터 LocalDate와 LocalDateTime이 등장하여 그간 Java의 기본 날짜 타입인 Date의 문제점을 제대로 고쳤으니 꼭 사용하자.</p>
<ul>
<li>BaseTimeEntity.java</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> lombok.Getter;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.annotation.CreatedDate;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.annotation.LastModifiedDate;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.jpa.domain.support.AuditingEntityListener;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.persistence.EntityListeners;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.MappedSuperclass;</span><br><span class="line"><span class="keyword">import</span> java.time.LocalDateTime;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@Getter</span></span><br><span class="line"><span class="meta">@MappedSuperclass</span></span><br><span class="line"><span class="meta">@EntityListeners(AuditingEntityListener.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">BaseTimeEntity</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@CreatedDate</span></span><br><span class="line">    <span class="keyword">private</span> LocalDateTime createDate;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@LastModifiedDate</span></span><br><span class="line">    <span class="keyword">private</span> LocalDateTime modifiedDate;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>BaseTimeEntity클래스는 모든 Entity의 상위 클래스가 되어 Entity들의 createdDate, modifiedDate를 자동으로 관리하는 역할이다.</p>
<ol>
<li>@MappedSuperclass</li>
</ol>
<ul>
<li>JPA Entity 클래스들이 BaseTimeEntity을 상속할 경우 필드들(createdDate, modifiedDate)도 컬럼으로 인식하도록 한다.</li>
</ul>
<ol start="2">
<li>@EntityListeners(AuditingEntityListener.class)</li>
</ol>
<ul>
<li>BaseTimeEntity 클래스에 Auditing 기능을 포함시킨다.</li>
</ul>
<ol start="3">
<li>CreatedDate</li>
</ol>
<ul>
<li>Entity가 생성되어 저장될 때 시간이 자동 저장된다.</li>
</ul>
<ol start="4">
<li>LastModifiedDate</li>
</ol>
<ul>
<li>조회한 Entity의 값을 변경할 때 시간이 자동 저장된다.</li>
</ul>
<p>이후 앞서 만든 Posts 클래스가 BaseTimeEntity를 상속받도록 변경한다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">  ...</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Posts</span> <span class="keyword">extends</span> <span class="title class_">BaseTimeEntity</span> &#123;</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>마지막으로 JPA Auditing 어노테이션들을 모두 활성화할 수 있도록 Application 클래스에 활성화 어노테이션을 추가한다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@EnableJpaAuditing</span> <span class="comment">// JPA Auditing 활성화</span></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Application</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        SpringApplication.run(Application.class, args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time datetime="2021-04-21T09:08:44.000Z" title="2021. 4. 21. 오후 6:08:44">2021-04-21</time>&nbsp;게시 됨</span><span class="level-item"><time datetime="2023-06-10T11:47:47.669Z" title="2023. 6. 10. 오후 8:47:47">2023-06-10</time>&nbsp;업데이트 됨</span><span class="level-item"><a class="link-muted" href="/categories/book/">book</a><span> / </span><a class="link-muted" href="/categories/book/springboot-aws-webservice/">springboot-aws-webservice</a></span><span class="level-item">5분안에 읽기 (약 817 단어)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2021/04/21/book/springboot-aws-webservice/2/">2.테스트코드 작성하기</a></h1><div class="content"><p>JUnit4 -&gt; 5 변경점</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">junit4 -&gt; 5</span><br><span class="line"></span><br><span class="line">  1. @Test</span><br><span class="line">  패키지 위치 변경</span><br><span class="line"></span><br><span class="line">org.junit.Test</span><br><span class="line"><span class="meta prompt_">-&gt; </span><span class="language-bash">org.junit.jupiter.api.Test</span></span><br><span class="line"></span><br><span class="line">  2. @RunWith</span><br><span class="line">  Junit5에서 @ExtendWith 로 변경되서 어노테이션명과 패키지위치 변경</span><br><span class="line"></span><br><span class="line">org.junit.runner.RunWith</span><br><span class="line"><span class="meta prompt_">-&gt; </span><span class="language-bash">org.junit.jupiter.api.extension.ExtendWith</span></span><br><span class="line"></span><br><span class="line">@RunWith</span><br><span class="line"><span class="meta prompt_">-&gt; </span><span class="language-bash">@ExtendWith</span></span><br><span class="line"></span><br><span class="line">  3. SpringRunner</span><br><span class="line">  SpringExtension 으로 변경되서 클래스명과 패키지위치 변경</span><br><span class="line"></span><br><span class="line">SpringRunner</span><br><span class="line"><span class="meta prompt_">-&gt; </span><span class="language-bash">SpringExtension</span></span><br><span class="line"></span><br><span class="line">org.springframework.test.context.junit4.SpringRunner</span><br><span class="line"><span class="meta prompt_">-&gt; </span><span class="language-bash">org.springframework.test.context.junit.jupiter.SpringExtension</span></span><br><span class="line"></span><br><span class="line">  4. @After</span><br><span class="line">  테스트 메소드가 끝날때마다 수행되는 @After 도 Junit5에서 @AfterEach 로 변경되었기 때문에 어노테이션과 패키지위치 변경</span><br><span class="line"></span><br><span class="line">@After</span><br><span class="line"><span class="meta prompt_">-&gt; </span><span class="language-bash">@AfterEach</span></span><br><span class="line"></span><br><span class="line">org.junit.After</span><br><span class="line"><span class="meta prompt_">-&gt; </span><span class="language-bash">org.junit.jupiter.api.AfterEach</span></span><br><span class="line"></span><br><span class="line">  5. @Before</span><br><span class="line">  마찬가지로 @BeforeEach 로 변경되서 어노테이션과 패키지위치 변경</span><br><span class="line"></span><br><span class="line">@Before</span><br><span class="line"><span class="meta prompt_">-&gt; </span><span class="language-bash">@BeforeEach</span></span><br><span class="line"></span><br><span class="line">org.junit.Before</span><br><span class="line"><span class="meta prompt_">-&gt; </span><span class="language-bash">org.junit.jupiter.api.BeforeEach</span></span><br></pre></td></tr></table></figure>
<p>샘플 컨트롤러 코드</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.jojoldu.book.springboot.web;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.GetMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"></span><br><span class="line"><span class="comment">//컨트롤러를 JSON을 반환하는 컨트롤러로 만들어준다.</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HelloController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//HTTP Method인 Get의 요청을 받을 수 있는 API를 만들어 준다.</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/hello&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">hello</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;hello&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>샘플 단위 테스트 코드</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.jojoldu.book.springboot.web;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.Test;</span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.extension.ExtendWith;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.autoconfigure.web.servlet.WebMvcTest;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.context.junit.jupiter.SpringExtension;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.web.servlet.MockMvc;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.springframework.test.web.servlet.request.MockMvcRequestBuilders.get;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.springframework.test.web.servlet.result.MockMvcResultMatchers.content;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.springframework.test.web.servlet.result.MockMvcResultMatchers.status;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">1. @ExtendWith(SpringExtension.class)</span></span><br><span class="line"><span class="comment">- 테스트를 진행할 때 JUnit에 내장된 실행자 외에 다른 실행자를 실행시킨다.</span></span><br><span class="line"><span class="comment">- 여기서는 SpringExtension 이라는 스프링 실행자를 사용한다.</span></span><br><span class="line"><span class="comment">- 스프링 부트 테스트와 JUnit 사이에 연결자 역할</span></span><br><span class="line"><span class="comment">- JUnit4 -&gt; 5로 넘어오면서 사용하는 어노테이션과 클래스가 각각 @RunWith -&gt; @ExtendWith 로 SpringRunner -&gt; SpringExtension 으로 변경되었다.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">2. @WebMvcTest</span></span><br><span class="line"><span class="comment">- 여러 스프링 테스트 어노테이션 중, Web(Spring MVC)에 집중할 수 있는 어노테이션</span></span><br><span class="line"><span class="comment">- 선언할 경우 @Controller, @ControllerAdvice 등을 사용할 수 있다.</span></span><br><span class="line"><span class="comment">- 단, @Service, @Component, @Repository 등은 사용할 수 없다.</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@ExtendWith(SpringExtension.class)</span><span class="comment">//1</span></span><br><span class="line"><span class="meta">@WebMvcTest(controllers = HelloController.class)</span><span class="comment">//2</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HelloControllerTest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    3. AutoWired</span></span><br><span class="line"><span class="comment">    - 스프링이 관리하는 빈(Bean)을 주입 받는다.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    4. private MockMvc mvc</span></span><br><span class="line"><span class="comment">    - 웹 API를 테스트할 때 사용한다.</span></span><br><span class="line"><span class="comment">    - 스프링 MVC 테스트의 시작점</span></span><br><span class="line"><span class="comment">    - 이 클래스를 통해 HTTP GET, POST 등에 대한 API 테스트를 할 수 있다.</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="meta">@Autowired</span><span class="comment">//3</span></span><br><span class="line">    <span class="keyword">private</span> MockMvc mvc;<span class="comment">//4</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> hello가_리턴된다() <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">hello</span> <span class="operator">=</span> <span class="string">&quot;hello&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        5. mvc.perform(get(&quot;/hello&quot;))</span></span><br><span class="line"><span class="comment">        - MockMvc를 통해 /hello 주소로 HTTP GET 요청을 한다.</span></span><br><span class="line"><span class="comment">        - 체이닝이 지원되어 아래와 같이 여러 검증 기능을 이어서 선언할 수 있다.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">        6. .andExpect(status().isOk())</span></span><br><span class="line"><span class="comment">        - mvc.perform의 결과를 검증한다.</span></span><br><span class="line"><span class="comment">        - HTTP Header의 Status를 검증한다.</span></span><br><span class="line"><span class="comment">        - 우리가 흔히 알고 있는 200, 404, 500 emddml 상태를 검증한다.</span></span><br><span class="line"><span class="comment">        - 여기선 OK 즉, 200인지 아닌지를 검증한다.</span></span><br><span class="line"><span class="comment">        </span></span><br><span class="line"><span class="comment">        7. .andExpect(content().string(hello))</span></span><br><span class="line"><span class="comment">        - mvc.perform의 결과를 검증한다.</span></span><br><span class="line"><span class="comment">        - 응답 본문의 내용을 검증한다.</span></span><br><span class="line"><span class="comment">        - Controller에서 &quot;hello&quot;를 리턴하기 때문에 이 값이 맞는지 검증한다.</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        mvc.perform(get(<span class="string">&quot;/hello&quot;</span>))<span class="comment">//5</span></span><br><span class="line">                .andExpect(status().isOk())<span class="comment">//6</span></span><br><span class="line">                .andExpect(content().string(hello));<span class="comment">//7</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="2-3-롬북-Lombok">2.3 롬북(Lombok)</h2>
<p>자바 개발 시 자주 사용하는 코드 Getteer, Setter, 기본생성자, toString 등을 어노테이션으로 자동 생성해준다.</p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">dependencies</span> &#123;</span><br><span class="line">    <span class="comment">// lombok</span></span><br><span class="line">    implementation(<span class="string">&#x27;org.projectlombok:lombok&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></article></div><nav class="pagination" role="navigation" aria-label="pagination"><div class="pagination-previous"><a href="/tags/book/page/3/">이전</a></div><div class="pagination-next"><a href="/tags/book/page/5/">다음</a></div><ul class="pagination-list is-hidden-mobile"><li><a class="pagination-link" href="/tags/book/">1</a></li><li><a class="pagination-link" href="/tags/book/page/2/">2</a></li><li><a class="pagination-link" href="/tags/book/page/3/">3</a></li><li><a class="pagination-link is-current" href="/tags/book/page/4/">4</a></li><li><a class="pagination-link" href="/tags/book/page/5/">5</a></li></ul></nav></div><div class="column column-left is-3-tablet is-3-desktop is-3-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="/img/avatar.png" alt="Jaeyong Yoo"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Jaeyong Yoo</p><p class="is-size-6 is-block">Backend Developer</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Seoul, Korea</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">포스트</p><a href="/archives"><p class="title">42</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">카테고리</p><a href="/categories"><p class="title">17</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">태그</p><a href="/tags"><p class="title">20</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/yoo0926" target="_blank" rel="external nofollow noopener noreferrer">팔로우</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="external nofollow noopener noreferrer" title="Github" href="https://github.com/yoo0926"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="external nofollow noopener noreferrer" title="Mail" href="mailto:wodydasktp@gmail.com"><i class="far fa-envelope"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/rss2.xml"><i class="fas fa-rss"></i></a></div></div></div><!--!--><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">카테고리</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/algorithm/"><span class="level-start"><span class="level-item">algorithm</span></span><span class="level-end"><span class="level-item tag">3</span></span></a><ul><li><a class="level is-mobile" href="/categories/algorithm/programmers/"><span class="level-start"><span class="level-item">programmers</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/blog/"><span class="level-start"><span class="level-item">blog</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/book/"><span class="level-start"><span class="level-item">book</span></span><span class="level-end"><span class="level-item tag">21</span></span></a><ul><li><a class="level is-mobile" href="/categories/book/clean-architecture/"><span class="level-start"><span class="level-item">clean-architecture</span></span><span class="level-end"><span class="level-item tag">11</span></span></a></li><li><a class="level is-mobile" href="/categories/book/spring5-reactive/"><span class="level-start"><span class="level-item">spring5-reactive</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/categories/book/springboot-aws-webservice/"><span class="level-start"><span class="level-item">springboot-aws-webservice</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/docker/"><span class="level-start"><span class="level-item">docker</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/etc/"><span class="level-start"><span class="level-item">etc</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/functional/"><span class="level-start"><span class="level-item">functional</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/git/"><span class="level-start"><span class="level-item">git</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/interview/"><span class="level-start"><span class="level-item">interview</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/spring/"><span class="level-start"><span class="level-item">spring</span></span><span class="level-end"><span class="level-item tag">6</span></span></a><ul><li><a class="level is-mobile" href="/categories/spring/WebFlux/"><span class="level-start"><span class="level-item">WebFlux</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/sql/"><span class="level-start"><span class="level-item">sql</span></span><span class="level-end"><span class="level-item tag">1</span></span></a><ul><li><a class="level is-mobile" href="/categories/sql/postgresql/"><span class="level-start"><span class="level-item">postgresql</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/web/"><span class="level-start"><span class="level-item">web</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">최근 글</h3><article class="media"><div class="media-content"><p class="date"><time datetime="2023-06-13T11:57:35.000Z">2023-06-13</time></p><p class="title"><a href="/2023/06/13/spring/WebFlux/spring-webflux-4/">[WebFlux] map과 flatMap에 대해서</a></p><p class="categories"><a href="/categories/spring/">spring</a> / <a href="/categories/spring/WebFlux/">WebFlux</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time datetime="2023-05-21T05:13:38.000Z">2023-05-21</time></p><p class="title"><a href="/2023/05/21/blog/hexo-upgrade/">Hexo 버전 업그레이드, 경고 지우기</a></p><p class="categories"><a href="/categories/blog/">blog</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time datetime="2023-04-17T09:34:51.000Z">2023-04-17</time></p><p class="title"><a href="/2023/04/17/spring/log4j-1/">log4j2 설정</a></p><p class="categories"><a href="/categories/spring/">spring</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time datetime="2023-04-04T00:46:08.000Z">2023-04-04</time></p><p class="title"><a href="/2023/04/04/spring/WebFlux/spring-webflux-3/">[WebFlux] Mono.defer(), Mono.fromCallable()</a></p><p class="categories"><a href="/categories/spring/">spring</a> / <a href="/categories/spring/WebFlux/">WebFlux</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time datetime="2023-04-02T14:13:58.000Z">2023-04-02</time></p><p class="title"><a href="/2023/04/02/book/clean-architecture/clean-11/">11. 의식적으로 지름길 사용하기</a></p><p class="categories"><a href="/categories/book/">book</a> / <a href="/categories/book/clean-architecture/">clean-architecture</a></p></div></article></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">아카이브</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2023/06/"><span class="level-start"><span class="level-item">6월 2023</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/05/"><span class="level-start"><span class="level-item">5월 2023</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/04/"><span class="level-start"><span class="level-item">4월 2023</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/03/"><span class="level-start"><span class="level-item">3월 2023</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/02/"><span class="level-start"><span class="level-item">2월 2023</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/01/"><span class="level-start"><span class="level-item">1월 2023</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/01/"><span class="level-start"><span class="level-item">1월 2022</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/12/"><span class="level-start"><span class="level-item">12월 2021</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/11/"><span class="level-start"><span class="level-item">11월 2021</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/09/"><span class="level-start"><span class="level-item">9월 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/08/"><span class="level-start"><span class="level-item">8월 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/06/"><span class="level-start"><span class="level-item">6월 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/05/"><span class="level-start"><span class="level-item">5월 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/04/"><span class="level-start"><span class="level-item">4월 2021</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/12/"><span class="level-start"><span class="level-item">12월 2020</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/11/"><span class="level-start"><span class="level-item">11월 2020</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">태그</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/JWT/"><span class="tag">JWT</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/algorithm/"><span class="tag">algorithm</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/blog/"><span class="tag">blog</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/book/"><span class="tag">book</span><span class="tag">21</span></a></div><div class="control"><a class="tags has-addons" href="/tags/docker/"><span class="tag">docker</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/functional/"><span class="tag">functional</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/git/"><span class="tag">git</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/googleTagManager/"><span class="tag">googleTagManager</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/hexo/"><span class="tag">hexo</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/interview/"><span class="tag">interview</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/java/"><span class="tag">java</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/kakao/"><span class="tag">kakao</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/kakaotalk/"><span class="tag">kakaotalk</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/open-graph/"><span class="tag">open graph</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/postgresql/"><span class="tag">postgresql</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/programmers/"><span class="tag">programmers</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/spring/"><span class="tag">spring</span><span class="tag">16</span></a></div><div class="control"><a class="tags has-addons" href="/tags/sql/"><span class="tag">sql</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/web/"><span class="tag">web</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%EC%9B%94%EA%B0%84%EC%BD%94%EB%93%9C%EC%B1%8C%EB%A6%B0%EC%A7%80/"><span class="tag">월간코드챌린지</span><span class="tag">1</span></a></div></div></div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">업데이트 소식 받기</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="구독"></div></div></form></div></div></div><div class="card widget"><div class="card-content"><div class="notification is-danger">You need to set <code>client_id</code> and <code>slot_id</code> to show this AD unit. Please set it in <code>_config.yml</code>.</div></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo-header.png" alt="하루하루 끄적끄적" height="28"></a><p class="is-size-7"><span>&copy; 2023 Jaeyong Yoo</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="external nofollow noopener noreferrer">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="external nofollow noopener noreferrer">Icarus</a><br><span id="busuanzi_container_site_uv"><span id="busuanzi_value_site_uv">0</span>명의 사용자가 방문 함</span></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="external nofollow noopener noreferrer" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="external nofollow noopener noreferrer" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="external nofollow noopener noreferrer" title="Download on GitHub" href="https://github.com/yoo0926/yoo0926.github.io"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("ko");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="맨 위로" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "이 웹 사이트는 귀하의 경험을 향상시키기 위해 Cookie를 사용합니다.",
          dismiss: "무시",
          allow: "허용",
          deny: "거부",
          link: "더 알아보기",
          policy: "Cookie 정책",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="입력 하세요..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"입력 하세요...","untitled":"(제목 없음)","posts":"포스트","pages":"페이지","categories":"카테고리","tags":"태그"});
        });</script></body></html>